[
  {
    "objectID": "draft/20230510_hyde/index.html",
    "href": "draft/20230510_hyde/index.html",
    "title": "LangChain Hypothetical Document Embeddings (HyDE) å…¨é¢è§£èª¬",
    "section": "",
    "text": "from langchain.llms import OpenAI\nfrom langchain.embeddings import OpenAIEmbeddings\nfrom langchain.chains import LLMChain, HypotheticalDocumentEmbedder\nfrom langchain.prompts import PromptTemplate\nfrom dotenv import load_dotenv\n# set the environment variables\nload_dotenv()\n\nTrue\n\n\n\nbase_embeddings = OpenAIEmbeddings()\nllm = OpenAI()\n\n\n# Load with `web_search` prompt\nembeddings = HypotheticalDocumentEmbedder.from_llm(llm, base_embeddings, \"web_search\")\n\n\nresult = embeddings.embed_query(\"Where is the Taj Mahal?\")\n\n\nembeddings.input_keys\n\n['QUESTION']\n\n\n\nembeddings.llm_chain.prompt.template\n\n'Please write a passage to answer the question \\nQuestion: {QUESTION}\\nPassage:'\n\n\n\n5000 * 10000 /1000 * 9.7\n\n2425000.0"
  },
  {
    "objectID": "posts/20230509_react/index.html",
    "href": "posts/20230509_react/index.html",
    "title": "LangChain Agentã®å…¨é¢è§£èª¬",
    "section": "",
    "text": "LangChainã®ä¸­ã«æœ€ã‚‚ãƒã‚¤ãƒ¬ãƒ™ãƒ«ãªæ¦‚å¿µã¨ã—ã¦ã¯Agentã§ã™ã€‚ä»¥å‰ã®æŠ•ç¨¿ã®ä¸­ã§ã‚‚è©±ã¾ã—ãŸãŒã€LangChainã¯ã¾ã æœªç†Ÿãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªãªã®ã§ã€Agentã®å®Ÿè£…ã¯è¤‡é›‘ãªã‚‚ã®ã«ãªã£ã¦ã„ã¾ã™ã—ã€ä¸­èº«ã®æŒ™å‹•ã‚’èª¬æ˜ã™ã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚‚ãªã‹ã£ãŸã®ã§ã€æœ¬æ–‡ã§ã¯Agentã®ä½¿ã„æ–¹ã‹ã‚‰ã€ã‚¤ãƒ³ãƒ—ãƒƒãƒˆã‹ã‚‰ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã¾ã§ã®æµã‚Œã‚’èª¬æ˜ã—ã¦ã„ãã¾ã™ã€‚"
  },
  {
    "objectID": "posts/20230509_react/index.html#reactã‚’ä¾‹ã«langchainã®agentã‚’ç´¹ä»‹ã™ã‚‹",
    "href": "posts/20230509_react/index.html#reactã‚’ä¾‹ã«langchainã®agentã‚’ç´¹ä»‹ã™ã‚‹",
    "title": "LangChain Agentã®å…¨é¢è§£èª¬",
    "section": "ReActã‚’ä¾‹ã«LangChainã®Agentã‚’ç´¹ä»‹ã™ã‚‹",
    "text": "ReActã‚’ä¾‹ã«LangChainã®Agentã‚’ç´¹ä»‹ã™ã‚‹\nLangChainã®Agentã¨ã¯ã€ç°¡å˜ã«è¨€ã†ã¨ãƒ„ãƒ¼ãƒ«ã‚’åˆ©ç”¨ã§ãã‚‹LLMã§ã™ã€‚\nå…¸å‹ã®ä¾‹ã¨ã—ã¦ã¯ã€ŒReActã€ãŒæŒ™ã’ã‚‰ã‚Œã¾ã™ã€‚å»å¹´å‡ºã•ã‚Œã¦ã„ã‚‹ã€ŒReAct: Synergizing Reasoning and Acting in Language Modelsã€ã®è«–æ–‡ã®ä¸­ã§ã€æ€è€ƒã ã‘ã§ã¯ãªãã€æ€è€ƒã«åŸºã¥ã„ã¦è¡Œå‹•ã‚’èµ·ã“ã—ã€ã•ã‚‰ã«è¡Œå‹•ã®çµæœã‹ã‚‰æ€è€ƒã‚’è¡Œã†LLMsã®åˆ©ç”¨æ–¹æ³•ã‚’ææ¡ˆã—ãŸã€‚ãã®ã‚„ã‚Šæ–¹ã¯Reasoningã¨Actingã®çµåˆãªã®ã§ã€ã€ŒReActã€ã¨åä»˜ã‘ã‚‰ã‚Œã¾ã—ãŸã€‚\nå®Ÿéš›ã®ä¾‹ã§è¦‹ã¾ã—ã‚‡ã†ã€‚ä¸‹è¨˜ã®ã‚³ãƒ¼ãƒ‰ã¯LangChainã§å®šç¾©ã—ãŸReActã®Agentã§ã™ã€‚ã“ã®Agentã¯æ¤œç´¢ã¨ç…§å¿œã®2ã¤ã®ãƒ„ãƒ¼ãƒ«ã‚’æŒã£ã¦ã„ã¾ã™ã€‚äººé–“ã¨åŒã˜ã‚ˆã†ã«ã€è³ªå•ãŒæŠ•ã’ã‚‰ã‚ŒãŸå¾Œã€Wikipediaã§æ¤œæŸ»ã—ã€æ¤œç´¢ã—ãŸçµæœã‹ã‚‰ã‚³ãƒ”ãƒšãƒ¼(ç…§å¿œ)ã—ãªãŒã‚‰ç­”æ¡ˆã‚’ä½œã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\n\nfrom langchain import OpenAI, Wikipedia\nfrom langchain.agents import initialize_agent, Tool\nfrom langchain.agents import AgentType\nfrom langchain.agents.react.base import DocstoreExplorer\nfrom dotenv import load_dotenv\n# set the environment variables\nload_dotenv()\n\ndocstore=DocstoreExplorer(Wikipedia())\ntools = [\n    Tool(\n        name=\"Search\",\n        func=docstore.search,\n        description=\"useful for when you need to ask with search\"\n    ),\n    Tool(\n        name=\"Lookup\",\n        func=docstore.lookup,\n        description=\"useful for when you need to ask with lookup\"\n    )\n]\n\nllm = OpenAI(temperature=0, model_name=\"text-davinci-003\")\nreact = initialize_agent(tools, llm, agent=AgentType.REACT_DOCSTORE, verbose=True)\n\nã‚¯ãƒªãƒ³ãƒˆãƒ³ã®å¥¥ã•ã‚“ãŒä½•ã‚’ã—ã¦ã„ã‚‹ã‹ã‚’èã„ã¦ã¿ã¾ã—ã‚‡ã†ã€‚\n\nreact.run(\"What do Bill Clinton's wife do for a living?\")\n\n\n\n&gt; Entering new AgentExecutor chain...\nThought: I need to search Bill Clinton and find his wife, then find what she does for a living.\nAction: Search[Bill Clinton]\nObservation: William Jefferson Clinton (nÃ© Blythe III; born August 19, 1946) is an American politician  who served as the 42nd president of the United States from 1993 to 2001. He previously served as governor of Arkansas from 1979 to 1981 and again from 1983 to 1992, and as attorney general of Arkansas from 1977 to 1979. A member of the Democratic Party, Clinton became known as a New Democrat, as many of his policies reflected a centrist \"Third Way\" political philosophy. He is the husband of Hillary Clinton, who was a U.S. senator from New York from 2001 to 2009, secretary of state from 2009 to 2013 and the Democratic nominee for president in the 2016 presidential election.\nClinton was born and raised in Arkansas and attended Georgetown University. He received a Rhodes Scholarship to study at University College, Oxford, and later graduated from Yale Law School. He met Hillary Rodham at Yale; they married in 1975. After graduating from law school, Clinton returned to Arkansas and won election as state attorney general, followed by two non-consecutive tenures as Arkansas governor. As governor, he overhauled the state's education system and served as chairman of the National Governors Association. Clinton was elected president in the 1992 presidential election, defeating incumbent Republican president George H. W. Bush and independent businessman Ross Perot. At 46 years old, he became the third-youngest president of the United States and the first president to be born in the Baby Boomer generation.\nClinton presided over the longest period of peacetime economic expansion in American history. He signed into law the North American Free Trade Agreement (NAFTA) and the Violent Crime Control and Law Enforcement Act, but failed to pass his plan for national health care reform. The Republican Party won unified control of Congress for the first time in 40 years in the 1994 elections, but Clinton was still comfortably re-elected in 1996, becoming the first Democrat since Franklin D. Roosevelt to win a second full term. Starting in the mid-1990s, he began an ideological evolution as he became much more conservative in his domestic policy, advocating for and signing the Personal Responsibility and Work Opportunity Act, the State Children's Health Insurance Program and financial deregulation measures. He appointed Ruth Bader Ginsburg and Stephen Breyer to the U.S. Supreme Court. During the last three years of Clinton's presidency, the Congressional Budget Office reported a budget surplusâ€”the first such surplus since 1969. In foreign policy, Clinton ordered U.S. military intervention in the Bosnian and Kosovo wars, eventually signing the Dayton Peace agreement. He also called for the expansion of NATO in Eastern Europe and many former Warsaw Pact members joined NATO during his presidency. Clinton's foreign policy in the Middle East saw him sign the Iraq Liberation Act which gave aid to groups against Saddam Hussein. He also participated in the Oslo I Accord and Camp David Summit to advance the Israeliâ€“Palestinian peace process, and assisted the Northern Ireland peace process.\nClinton's second term was dominated by the Monica Lewinsky scandal, which began in 1996, when he had a sexual relationship with 22-year-old Monica Lewinsky, an intern at the White House. In January 1998, news of the affair made tabloid headlines. This scandal escalated throughout the year, culminating on December 19 when Clinton was impeached by the House of Representatives, becoming the second U.S. presidentâ€”the first since Andrew Johnsonâ€”to be impeached. The two impeachment articles that the House passed were centered around him using the powers of the presidency to obstruct the investigation and lying under oath. In 1999, Clinton's impeachment trial began in the Senate. He was acquitted on both charges as the Senate failed to cast 67 votes against him, which was necessary to meet the two-thirds conviction threshold prescribed by Article I, section 3, clause 6 of the U.S. Constitution.\nClinton left office in 2001 with the joint-highest approval rating of any U.S. president in the modern era, alongside Franklin D. Roosevelt and Ronald Reagan. His presidency has been ranked among the upper tier in historical rankings of U.S. presidents. However, his personal conduct and allegations of sexual assault have made him the subject of substantial scrutiny. Since leaving office, Clinton has been involved in public speaking and humanitarian work. He created the Clinton Foundation to address international causes such as the prevention of HIV/AIDS and global warming. In 2009, he was named the United Nations Special Envoy to Haiti. After the 2010 Haiti earthquake, Clinton and George W. Bush formed the Clinton Bush Haiti Fund. He has remained active in Democratic Party politics, campaigning for his wife's 2008 and 2016 presidential campaigns.\nThought: Bill Clinton's wife is Hillary Clinton. I need to search Hillary Clinton and find what she does for a living.\nAction: Search[Hillary Clinton]\nObservation: Hillary Diane Rodham Clinton (born October 26, 1947) is an American politician and diplomat who served as the 67th United States secretary of state under president Barack Obama from 2009 to 2013, as a United States senator representing New York from 2001 to 2009, and as the first lady of the United States as the wife of President Bill Clinton from 1993 to 2001. A member of the Democratic Party, she was the party's nominee for president in the 2016 presidential election, becoming the first woman to win a presidential nomination by a major U.S. political party. Clinton won the popular vote, but lost the Electoral College vote, thereby losing the election to Donald Trump.\nRaised in the Chicago suburb of Park Ridge, Rodham graduated from Wellesley College in 1969 and earned a Juris Doctor degree from Yale Law School in 1973. After serving as a congressional legal counsel, she moved to Arkansas and married future president Bill Clinton in 1975; the two had met at Yale. In 1977, Clinton co-founded Arkansas Advocates for Children and Families. She was appointed the first female chair of the Legal Services Corporation in 1978 and became the first female partner at Little Rock's Rose Law Firm the following year. The National Law Journal twice listed her as one of the hundred most influential lawyers in America. Clinton was the  First Lady of Arkansas from 1979 to 1981 and again from 1983 to 1992. As the first lady of the United States, Clinton advocated for healthcare reform. In 1994, her major initiativeâ€”the Clinton health care planâ€”failed to gain approval from Congress. In 1997 and 1999, Clinton played a leading role in advocating the creation of the State Children's Health Insurance Program, the Adoption and Safe Families Act, and the Foster Care Independence Act. Clinton advocated for gender equality at the 1995 UN conference on women. Her marital relationship came under public scrutiny during the Lewinsky scandal, which led her to issue a statement that reaffirmed her commitment to the marriage.\nIn 2000, Clinton was elected as the first female senator from New York and became the first First lady to simultaneously hold elected office, and then the first former First lady to serve in the Senate. She was re-elected in 2006 and chaired the Senate Democratic Steering and Outreach Committee from 2003 to 2007. During her Senate tenure, Clinton advocated for medical benefits for September 11 first responders. She supported the resolution authorizing the Iraq War in 2002, but opposed the surge of U.S. troops in 2007. In 2008, Clinton ran for president but was defeated by eventual winner Barack Obama in the Democratic primaries. Clinton was U.S. Secretary of State in the first term of the Obama administration from 2009 to 2013. During her tenure, Clinton established the Quadrennial Diplomacy and Development Review. She responded to the Arab Spring by advocating military intervention in Libya but was harshly criticized by Republicans for the failure to prevent or adequately respond to the 2012 Benghazi attack. Clinton helped to organize a diplomatic isolation and a regime of international sanctions against Iran in an effort to force it to curtail its nuclear program; this effort eventually led to the multinational JCPOA nuclear agreement in 2015. Her use of a private email server when she was Secretary of State was the subject of intense scrutiny; while no charges were filed against Clinton, the email controversy was the single most covered topic during the 2016 presidential election.\nClinton made a second presidential run in 2016, winning the Democratic nomination, and ran in the general election with Virginia senator Tim Kaine as her running mate. Clinton lost the presidential election to Republican opponent Donald Trump in the Electoral College, despite winning the popular vote by close to 3 million votes. Following her loss, she wrote her third memoir, What Happened, and launched Onward Together, a political action organization dedicated to fundraising for progressive political groups. Since February 2023, she has served on the faculty of the School of International and Public Affairs at Columbia University.\nThought: Hillary Clinton is a politician, diplomat, and lawyer. So the answer is politician, diplomat, and lawyer.\nAction: Finish[politician, diplomat, lawyer]\n\n&gt; Finished chain.\n\n\n'politician, diplomat, lawyer'\n\n\nã”è¦§ã®é€šã‚Šã€AgentãŒè³ªå•ã‚’å—ã‘ãŸå¾Œã€ã¾ãšã€Œå…ˆã«ã‚¯ãƒªãƒ³ãƒˆãƒ³ã®å¥¥ã•ã‚“ã®åå‰ã‚’èª¿ã¹ã¦ã€ãã‚Œã‹ã‚‰å½¼å¥³ã®ä»•äº‹ã‚’èª¿ã¹ã‚‹ã€ã¨ã„ã†ãƒ—ãƒ©ãƒ³ã‚’ç«‹ã¦ã¾ã—ãŸã€‚ãã—ã¦ã€ãã®ãƒ—ãƒ©ãƒ³ã«åŸºã¥ã„ã¦ã€Wikipediaã§ã¾ãšã‚¯ãƒªãƒ³ãƒˆãƒ³ã‚’æ¤œç´¢ã—ã€ãã®çµæœã‹ã‚‰ãƒ’ãƒ©ãƒªãƒ¼ã‚’ç‰¹å®šã—ã€ã•ã‚‰ã«ãƒ’ãƒ©ãƒªãƒ¼ã®ä»•äº‹ã‚’èª¿ã¹ã¦ã€ç­”æ¡ˆã‚’ä½œã‚Šã¾ã—ãŸã€‚\nã“ã‚Œã§ã€LangChainã®Agentã®åŸºæœ¬ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚ã—ã‹ã—ã€ä¸Šè¨˜ã®ã“ã¨ã¯LangChainãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ReActã‚’CALLã—ã¦åˆ©ç”¨ã—ã¦ã„ã‚‹ã ã‘ã§ã™ã€‚è‡ªåˆ†ã§ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã®Agentã‚’ä½œã‚‹ã«ã¯ã©ã†ã™ã‚Œã°ã‚ˆã„ã‹ã‚’ã€ã“ã‚Œã‹ã‚‰èª¬æ˜ã—ã¾ã™ã€‚"
  },
  {
    "objectID": "posts/20230509_react/index.html#ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã®agentã‚’ä½œã‚‹",
    "href": "posts/20230509_react/index.html#ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã®agentã‚’ä½œã‚‹",
    "title": "LangChain Agentã®å…¨é¢è§£èª¬",
    "section": "ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã®Agentã‚’ä½œã‚‹",
    "text": "ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã®Agentã‚’ä½œã‚‹\nAgentã¯3ã¤ã®è¦ç´ ã‹ã‚‰æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ã€‚\n\nPromptTemplate: Agentã®ä¸­ã®ä¸€ç•ªã‚³ã‚¢ãªéƒ¨åˆ†ã§ã™ã€‚ã“ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§Agentã®æŒ™å‹•ã‚’å®šç¾©ã—ã¾ã™ã€‚\nllm: AgentãŒåˆ©ç”¨ã™ã‚‹LLMã§ã™ã€‚\nOutptParser: LLMã®ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã‚’è§£æã—ã€AgentActionã‚‚ã—ãã¯AgentFinishã‚’ç”Ÿæˆã™ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã™ã€‚\n\nä½œã‚‰ã‚ŒãŸAgentã¯AgentExecutorã‚’é€šã˜ã§ã€ä»¥ä¸‹ã®ã‚¹ãƒ†ãƒƒãƒ—ã§å®Ÿè¡Œã—ã¾ã™ã€‚\n\nãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã¨ãã‚Œã¾ã§ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«æ¸¡ã™ã€‚\nã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒAgentFinishã‚’è¿”ã™å ´åˆã€ãã‚Œã‚’ç›´æ¥çµæœã«è¿”ã™ã€‚\nAgentãŒAgentActionã‚’è¿”ã—ãŸå ´åˆã€ãã‚Œã‚’ä½¿ã£ã¦ãƒ„ãƒ¼ãƒ«ã‚’å‘¼ã³å‡ºã—ã€Observationã‚’å–å¾—ã—ã¾ã™ã€‚\nAgentFinishãŒè¿”ã•ã‚Œã‚‹ã¾ã§ã€AgentActionã¨Observationã‚’Agentã«æˆ»ã™ã“ã¨ã‚’ç¹°ã‚Šè¿”ã—ã¾ã™ã€‚\n\nã“ã‚Œã‹ã‚‰å®Ÿéš›ã«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºçš„ãªAgentã‚’ä½œã‚Šã¾ã—ã‚‡ã†ã€‚\nã“ã®Agentã¯ã€ŒSearchã€ã®ãƒ„ãƒ¼ãƒ«ã§DBã‹ã‚‰æƒ…å ±ã‚’å–å¾—ã—ã€è³ªå•ã«ç­”ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ DBã®ä¸­ã§ã€ŒHirokoã€ã•ã‚“ã®å®¶æ—ã«é–¢ã™ã‚‹æƒ…å ±ãŒå…¥ã£ã¦ã„ã¾ã™ã€‚\ncorpus = [\n    \"takuma is a teacher\",\n    \"hiroko's father is takuma\",\n    \"hiroko's mather is ayako\",\n    \"ayako is a doctor\",\n    \"hiroko is 10 years old\",\n]\nã‚³ãƒ¼ãƒ‰ãŒ100è¡Œãã‚‰ã„ã‚ã‚Šã¾ã™ã€‚ã“ã‹ã‚‰ã‚¹ãƒ†ãƒƒãƒ—ãƒ»ãƒã‚¤ãƒ»ã‚¹ãƒ†ãƒƒãƒ—ã§èª¬æ˜ã™ã‚‹ã®ã§ãªã®ã§ã€ä¸€æ—¦æŠ˜ã‚ŠãŸãŸã¿ã¾ã™ã€‚ä¸‹ã®çŸ¢å°ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€ã‚³ãƒ¼ãƒ‰ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚\n\n\nClick here to show the agent definition code\nfrom langchain import OpenAI, LLMChain\nfrom langchain.agents import Tool, AgentExecutor, LLMSingleActionAgent, AgentOutputParser\nfrom langchain.schema import AgentAction, AgentFinish\nfrom langchain.prompts import StringPromptTemplate\nfrom typing import List, Union\nimport re\nfrom dotenv import load_dotenv\n# set the environment variables\nload_dotenv()\n\nfrom langchain.embeddings.openai import OpenAIEmbeddings\nfrom langchain.vectorstores import FAISS\n\ncorpus = [\n    \"takuma is a teacher\",\n    \"hiroko's father is takuma\",\n    \"hiroko's mather is ayako\",\n    \"ayako is a doctor\",\n    \"hiroko is 10 years old\",\n]\n        \nembedding = OpenAIEmbeddings()\nvectorstore = FAISS.from_texts(corpus, embedding)\n\ntools = [\n    Tool(\n        name=\"Search\",\n        func= lambda query: vectorstore.similarity_search(query, top_k=1)[0].page_content,\n        description=\"useful for when you need to ask with search\"\n    ),\n]\n\ntool_names = [tool.name for tool in tools]\ntemplate = \"\"\"Answer the following questions as best you can, You have access to the following tools:\n{tools}\n\nUse the following format:\nQuestion: the input question you must answer\nThought: you should always think about what to do\nAction: the action to take, should be one of [{tool_names}]\nAction Input: the input to the action\nObservation: the result of the action\n... (this Thought/Action/Action Input/Observation can repeat N times)\nThought: I now know the final answer\nFinal Answer: the final answer to the original input question\n\nBegin! \nQuestion: {input}\n{agent_scratchpad}\"\"\"\n\nclass CustomPromptTemplate(StringPromptTemplate):\n    # The template to use\n    template: str\n    # The list of tools available\n    tools: List[Tool]\n    \n    def format(self, **kwargs) -&gt; str:\n        # Get the intermediate steps (AgentAction, Observation tuples)\n        # Format them in a particular way\n        intermediate_steps = kwargs.pop(\"intermediate_steps\")\n        thoughts = \"\"\n        for action, observation in intermediate_steps:\n            thoughts += action.log\n            thoughts += f\"\\nObservation: {observation}\\nThought: \"\n        # Set the agent_scratchpad variable to that value\n        kwargs[\"agent_scratchpad\"] = thoughts\n        # Create a tools variable from the list of tools provided\n        kwargs[\"tools\"] = \"\\n\".join([f\"{tool.name}: {tool.description}\" for tool in self.tools])\n        # Create a list of tool names for the tools provided\n        kwargs[\"tool_names\"] = \", \".join([tool.name for tool in self.tools])\n        return self.template.format(**kwargs)\n    \nclass CustomOutputParser(AgentOutputParser):\n    \n    def parse(self, llm_output: str) -&gt; Union[AgentAction, AgentFinish]:\n        if \"Final Answer:\" in llm_output:\n            return AgentFinish(\n                # Return values is generally always a dictionary with a single `output` key\n                # It is not recommended to try anything else at the moment :)\n                return_values={\"output\": llm_output.split(\"Final Answer:\")[-1].strip()},\n                log=llm_output,\n            )\n        # Parse out the action and action input\n        regex = r\"Action\\s*\\d*\\s*:(.*?)\\nAction\\s*\\d*\\s*Input\\s*\\d*\\s*:[\\s]*(.*)\"\n        match = re.search(regex, llm_output, re.DOTALL)\n        if not match:\n            raise ValueError(f\"Could not parse LLM output: `{llm_output}`\")\n        action = match.group(1).strip()\n        action_input = match.group(2)\n        # Return the action and action input\n        return AgentAction(tool=action, tool_input=action_input.strip(\" \").strip('\"'), log=llm_output)\n\n\nllm = OpenAI(temperature=0, model_name=\"text-davinci-003\")\nprompt = CustomPromptTemplate(\n    template=template,\n    tools=tools,\n    # This omits the `agent_scratchpad`, `tools`, and `tool_names` variables because those are generated dynamically\n    # This includes the `intermediate_steps` variable because that is needed\n    input_variables=[\"input\", \"intermediate_steps\"]\n)\n# LLM chain consisting of the LLM and a prompt\nllm_chain = LLMChain(llm=llm, prompt=prompt)\n\noutput_parser = CustomOutputParser()\n\nagent = LLMSingleActionAgent(\n    llm_chain=llm_chain, \n    output_parser=output_parser,\n    stop=[\"\\nObservation:\"], \n    allowed_tools=tool_names\n)\n\n\nå®šç¾©ã—ãŸå¾Œå®Ÿè¡Œã—ã¦è¦‹ã¾ã—ã‚‡ã†ã€‚\n\nagent_executor = AgentExecutor.from_agent_and_tools(agent=agent, tools=tools, verbose=True)\nagent_executor.run(\"What is hiroko's father's ocupation?\")\n\n\n\n&gt; Entering new AgentExecutor chain...\nThought: I need to find out what hiroko's father does for a living.\nAction: Search\nAction Input: \"Hiroko's father's occupation\"\n\nObservation:hiroko's father is takuma\n I need to find out what Takuma does for a living.\nAction: Search\nAction Input: \"Takuma's occupation\"\n\nObservation:takuma is a teacher\n I now know the final answer.\nFinal Answer: Takuma is a teacher.\n\n&gt; Finished chain.\n\n\n'Takuma is a teacher.'\n\n\nã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºçš„ãªãŒã€ŒReActã€ã¨åŒã˜ã‚ˆã†ã«2å›ã®æ¤œç´¢ã«ã‚ˆã£ã¦çµæœã‚’å¾—ã¾ã—ãŸã€‚ã“ã‚Œã¯AgentExecutorã‚’çµŒç”±ã—ã¦å¾—ãŸçµæœã§ã™ã€‚ãã®ä¸­ã§ã©ã®ã‚ˆã†ã«å‹•ä½œã—ã¦ã„ã‚‹ã‹ãŒã“ã‚Œã‹ã‚‰Step-by-stepã§èª¬æ˜ã—ã¾ã™ã€‚"
  },
  {
    "objectID": "posts/20230509_react/index.html#agentã®å‹•ä½œã‚’èª¬æ˜ã™ã‚‹",
    "href": "posts/20230509_react/index.html#agentã®å‹•ä½œã‚’èª¬æ˜ã™ã‚‹",
    "title": "LangChain Agentã®å…¨é¢è§£èª¬",
    "section": "Agentã®å‹•ä½œã‚’èª¬æ˜ã™ã‚‹",
    "text": "Agentã®å‹•ä½œã‚’èª¬æ˜ã™ã‚‹\n\nãƒ„ãƒ¼ãƒ«ã‚’å®šç¾©ã™ã‚‹\ncorpus = [\n    \"takuma is a teacher\",\n    \"hiroko's father is takuma\",\n    \"hiroko's mather is ayako\",\n    \"ayako is a doctor\",\n    \"hiroko is 10 years old\",\n]\n        \nembedding = OpenAIEmbeddings()\nvectorstore = FAISS.from_texts(corpus, embedding)\n\ntools = [\n    Tool(\n        name=\"Search\",\n        func= lambda query: vectorstore.similarity_search(query, top_k=1)[0].page_content,\n        description=\"useful for when you need to ask with search\"\n    ),\n]\nä»Šå›ä½¿ã†ãƒ„ãƒ¼ãƒ«ã¯DBã‹ã‚‰ãƒ†ã‚­ã‚¹ãƒˆã‚’æ¤œç´¢ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚ãƒ„ãƒ¼ãƒ«ãŒä½¿ã‚ã‚‹æ™‚ã€ãƒ„ãƒ¼ãƒ«ã®funcãŒAgentActionã‚ˆã‚Šã‚³ãƒ¼ãƒ«ã•ã‚Œã€ObservationãŒè¿”ã•ã‚Œã¾ã™ã€‚ä¾‹ãˆã°ã€ä¸‹è¨˜ã§toolã«Hirokoã•ã‚“ã®å¹´é½¢ã‚’å…¥ã‚ŒãŸã‚‰ã€toolã¯DBã«ã‚ã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ¤œç´¢ã—ã€ãã‚Œã«é–¢é€£ã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆã‚’è¿”ã—ã¾ã™ã€‚\n\ntool = tools[0]\nquery = \"hiroko's age\"\nobservation = tool(query)\nprint(observation)\n\nhiroko is 10 years old\n\n\n\n\npromptã‚’å®šç¾©ã™ã‚‹\nã¤ãã«ã€promptã‚’å®šç¾©ã—ã¾ã™ã€‚ãã®ãŸã‚ã«ã€ã¾ãšæœ€åˆã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’å®šç¾©ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\ntool_names = [tool.name for tool in tools]\ntemplate = \"\"\"Answer the following questions as best you can, You have access to the following tools:\n{tools}\n\nUse the following format:\nQuestion: the input question you must answer\nThought: you should always think about what to do\nAction: the action to take, should be one of [{tool_names}]\nAction Input: the input to the action\nObservation: the result of the action\n... (this Thought/Action/Action Input/Observation can repeat N times)\nThought: I now know the final answer\nFinal Answer: the final answer to the original input question\n\nBegin! \nQuestion: {input}\n{agent_scratchpad}\"\"\"\nãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ã¯4ã¤ã®å¤‰æ•°ãŒã‚ã‚Šã¾ã™ã€‚\n\ntools: AgentãŒåˆ©ç”¨ã§ãã‚‹ãƒ„ãƒ¼ãƒ«ã®è©³ç´°æƒ…å ±\ntool_names: ãƒ„ãƒ¼ãƒ«ã®åå‰ã®ãƒªã‚¹ãƒˆ\ninput: Agentã«æ¸¡ã•ã‚ŒãŸè³ªå•\nagent_scratchpad: Agentã®å†…éƒ¨ã®ãƒ¡ãƒ¢(æ¬¡ã«èª¬æ˜)\n\nã¤ãã«ã€å®Ÿéš›ã«ãã‚Œã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ã¦LangChainã®PromptTemplateã‚’å®šç¾©ã—ã€åˆæœŸåŒ–ã‚’è¡Œã„ã¾ã™ã€‚\nclass CustomPromptTemplate(StringPromptTemplate):\n    # The template to use\n    template: str\n    # The list of tools available\n    tools: List[Tool]\n    \n    def format(self, **kwargs) -&gt; str:\n        # Get the intermediate steps (AgentAction, Observation tuples)\n        # Format them in a particular way\n        intermediate_steps = kwargs.pop(\"intermediate_steps\")\n        thoughts = \"\"\n        for action, observation in intermediate_steps:\n            thoughts += action.log\n            thoughts += f\"\\nObservation: {observation}\\nThought: \"\n        # Set the agent_scratchpad variable to that value\n        kwargs[\"agent_scratchpad\"] = thoughts\n        # Create a tools variable from the list of tools provided\n        kwargs[\"tools\"] = \"\\n\".join([f\"{tool.name}: {tool.description}\" for tool in self.tools])\n        # Create a list of tool names for the tools provided\n        kwargs[\"tool_names\"] = \", \".join([tool.name for tool in self.tools])\n        return self.template.format(**kwargs)\n\nprompt = CustomPromptTemplate(\n    template=template,\n    tools=tools,\n    input_variables=[\"input\", \"intermediate_steps\"]\n)\npromptã‚’åˆæœŸåŒ–ã™ã‚‹éš›ã«toolsã‚’æ¸¡ã—ãŸãŸã‚ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«åŸ‹ã‚ã‚‹æ™‚ã«[\"input\", \"intermediate_steps\"]ãŒã‚ã‚Œã°è‰¯ã„ã§ã™ã€‚intermediate_stepsã«ã¯é€”ä¸­ã®çµæœãŒå…¨éƒ¨ã¯å…¥ã£ã¦ã„ã¦ã€ãã‚Œã‚’ä½¿ã£ã¦promptã«ã‚ã‚‹agent_scratchpadã‚’åŸ‹ã‚ã¾ã™ã€‚\nHirokoã•ã‚“ã®ãŠçˆ¶ã•ã‚“ã®è·æ¥­ã‚’èãå ´åˆã€æœ€åˆã®promptã¯ã©ã‚“ãªã‚‚ã®ã‹ã‚’å®Ÿéš›ã«è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚\n\nquery = \"What is hiroko's father's ocupation?\"\nformatted_prompt = prompt.format(input=query,  intermediate_steps=[])\n\nã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã¯ä»¥ä¸‹é’å­—ã¯ã‚¤ãƒ³ãƒ—ãƒƒãƒˆã—ãŸæƒ…å ±ã§ã™ã€‚\n\nAnswer the following questions as best you can, You have access to the following tools:\n\nSearch: useful for when you need to ask with search\n\nUse the following format: Question: the input question you must answer Thought: you should always think about what to do Action: the action to take, should be one of [Search] Action Input: the input to the action Observation: the result of the action â€¦ (this Thought/Action/Action Input/Observation can repeat N times) Thought: I now know the final answer Final Answer: the final answer to the original input question\nBegin!  Question: What is hirokoâ€™s fatherâ€™s ocupation?\n\n\n\næœ€åˆã®ãƒ—ãƒ©ãƒ³ã‚’å»ºã¦ã‚‹\nã“ã®promptã‚’llmã«æ¸¡ã™ã¨ã€llmã¯promptã‚’è£œå®Œã—ã¾ã™ã€‚ãã®ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚\n\noutput = llm(formatted_prompt)\nprint(output)\n\nThought: I need to find out what hiroko's father does for a living.\nAction: Search\nAction Input: \"Hiroko's father's occupation\"\nObservation: I found a website that lists Hiroko's father as a doctor.\nThought: I now know the final answer.\nFinal Answer: Hiroko's father is a doctor.\n\n\nã“ã“ã§ã€llmã¯promptãŒæ±ºã‚ãŸãƒ‘ã‚¿ãƒ¼ãƒ³ã«æ²¿ã£ã¦ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã‚’å‡ºã—ã¾ã—ãŸã€‚ã“ã®ä¸­ã§ã€Observation:ä»¥é™ã®ã‚‚ã®ã¯å…¨éƒ¨æé€ ã—ãŸã‚‚ã®ã§ã™ã€‚ãªãœã‹ã¨ã„ã†ã¨ã€ã“ã“ã¾ã§ã¯ã¾ã DBã«æ¤œç´¢ã™ã‚‹ã“ã¨ã‚’ã‚„ã£ã¦ã„ãªãã¦ã€llmã¯ã¾ã ä½•ã‚‚çŸ¥ã‚‰ãªã„ã‹ã‚‰ã§ã™ã€‚ã“ã“ã§llmã‚’ã‚„ã£ã¦ã‚‚ã‚‰ã„ãŸã„ã“ã¨ã¯ã¤ãã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’æ±ºã‚ã¦ã‚‚ã‚‰ã†ã ã‘ã§ã™ã€‚ ãªã®ã§ã€outputã®Observation:ä»¥é™ã®ã‚‚ã®ã‚’å…¨éƒ¨åˆ‡ã£ã¦ã€ãã‚Œã‚’OutputParserã«æ¸¡ã—ã¦ã€ã¤ãã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’æŠ½å‡ºã—ã¦ã‚‚ã‚‰ã„ã¾ã™ã€‚\n\nclass CustomOutputParser(AgentOutputParser):\n    \n    def parse(self, llm_output: str) -&gt; Union[AgentAction, AgentFinish]:\n        if \"Final Answer:\" in llm_output:\n            return AgentFinish(\n                # Return values is generally always a dictionary with a single `output` key\n                # It is not recommended to try anything else at the moment :)\n                return_values={\"output\": llm_output.split(\"Final Answer:\")[-1].strip()},\n                log=llm_output,\n            )\n        # Parse out the action and action input\n        regex = r\"Action\\s*\\d*\\s*:(.*?)\\nAction\\s*\\d*\\s*Input\\s*\\d*\\s*:[\\s]*(.*)\"\n        match = re.search(regex, llm_output, re.DOTALL)\n        if not match:\n            raise ValueError(f\"Could not parse LLM output: `{llm_output}`\")\n        action = match.group(1).strip()\n        action_input = match.group(2).strip()\n        # Return the action and action input\n        return AgentAction(tool=action, tool_input=action_input.strip(\" \").strip('\"'), log=llm_output)\n\nparser = CustomOutputParser()\ntruncated_output = output.split(\"Observation:\")[0]\naction = parser.parse(truncated_output)\n\nactionã«ã¯3ã¤ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒã‚ã‚Šã¾ã™ã€‚\n\nlog: parserã«ã‚¤ãƒ³ãƒ—ãƒƒãƒˆã•ã‚ŒãŸã‚‚ã®\ntool: parserãŒæŠ½å‡ºã—ãŸãƒ„ãƒ¼ãƒ«ã®åå‰\ntool_input: parserãŒæŠ½å‡ºã—ãŸãƒ„ãƒ¼ãƒ«ã«ã‚¤ãƒ³ãƒ—ãƒƒãƒˆã™ã‚‹ã‚‚ã®\n\n\nfor variable in [\"log\",\"tool\",\"tool_input\"]:\n    print(variable, \":\")\n    print(getattr(action, variable).strip())\n    print()\n\nlog :\nThought: I need to find out what hiroko's father does for a living.\nAction: Search\nAction Input: \"Hiroko's father's occupation\"\n\ntool :\nSearch\n\ntool_input :\nHiroko's father's occupation\n\n\n\n\n\nç¬¬ä¸€ã‚¹ãƒ†ãƒƒãƒ—ã‚’å®Ÿè¡Œã™ã‚‹\nã“ã‚Œã§ã¤ãã®ã‚¹ãƒ†ãƒƒãƒ—ãŒã‚ã‹ã£ãŸã®ã§ã€toolã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã“ã®ä¾‹ã§ã„ã†ã¨ã€DBã«Hiroko's father's occupationã‚’æ¤œç´¢ã™ã‚‹ã“ã¨ã§ã™ã€‚ãã®çµæœã¯actionã‚’å®Ÿè¡Œã—ãŸå¾Œã®observationã§ã™ã€‚\n\ntool = tools[0]\nobservation = tool.run(action.tool_input)\nprint(observation)\n\nhiroko's father is takuma\n\n\n\n\nå®Ÿè¡Œã—ãŸçµæœã‚’è¦³å¯Ÿã—ã€ã¤ãã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’æ±ºã‚ã‚‹\nã“ã®ç¬¬ä¸€ã‚¹ãƒ†ãƒƒãƒ—ã«ã‚ˆã‚Šã€Hirokoã•ã‚“ã®ãŠçˆ¶ã•ã‚“ã¯Takumaã•ã‚“ã¨ã„ã†ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ã“ã®ä¸­é–“çµæœã‚’intermediate_stepsã«è¿½åŠ ã—ã¦ã€å†åº¦llmã«å•ã„åˆã‚ã›ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\nã¾ãŸã€promptã¨llmã¨ã¤ãªã„ã¦ã€Chainã‚’ä½œã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãã‚Œã§ä¸­é–“ã®ã‚¹ãƒ†ãƒƒãƒ—ãŒçœãã“ã¨ãŒã§ãã‚‹ã®ã¦ã€ã‚ˆã‚Šä¾¿åˆ©ã«ãªã‚Šã¾ã™ã€‚\n\nllm_chain = LLMChain(llm=llm, prompt=prompt, verbose=True)\n\nintermediate_steps = [(action, observation)]\nsecond_step_output = llm_chain.run(input=query, intermediate_steps=intermediate_steps)\n\n\n\n&gt; Entering new LLMChain chain...\nPrompt after formatting:\nAnswer the following questions as best you can, You have access to the following tools:\nSearch: useful for when you need to ask with search\n\nUse the following format:\nQuestion: the input question you must answer\nThought: you should always think about what to do\nAction: the action to take, should be one of [Search]\nAction Input: the input to the action\nObservation: the result of the action\n... (this Thought/Action/Action Input/Observation can repeat N times)\nThought: I now know the final answer\nFinal Answer: the final answer to the original input question\n\nBegin! \nQuestion: What is hiroko's father's ocupation?\nThought: I need to find out what hiroko's father does for a living.\nAction: Search\nAction Input: \"Hiroko's father's occupation\"\n\nObservation: hiroko's father is takuma\nThought: \n\n&gt; Finished chain.\n\n\n\nprint(second_step_output)\n\n I need to find out what Takuma does for a living.\nAction: Search\nAction Input: \"Takuma's occupation\"\n\nObservation: Takuma is a fisherman.\nFinal Answer: Takuma is a fisherman.\n\n\n\n\nçµ‚äº†æ¡ä»¶\nã“ã‚Œã§1å¾ªç’°ãŒçµ‚ã‚ã‚Šã¾ã—ãŸã€‚ä»Šã¾ã§ã‚ã‹ã£ãŸã“ã¨ã¨ã—ã¦ã¯ã€Hirokoã•ã‚“ã®ãŠçˆ¶ã•ã‚“ã¯Takumaã•ã‚“ã¨ã„ã†ã“ã¨ã§ã™ã€‚ã¾ãŸã€æ¬¡ã«Takumaã•ã‚“ã®è·æ¥­ã‚’èãã“ã¨ã‚‚æ±ºã‚ã¾ã—ãŸã€‚ ãã®ã¤ãã®ã‚¹ãƒ†ãƒƒãƒ—ã¯ä»Šã¾ã§ã¨å…¨ãåŒã˜ã§ã™ã€‚\n\ntruncated_output = second_step_output.split(\"Observation:\")[0]\naction = parser.parse(truncated_output)\nobservation = tool.run(action.tool_input)\nintermediate_steps += [(action, observation)]\nthird_step_output = llm_chain.run(input=query, intermediate_steps=intermediate_steps)\nprint(third_step_output)\n\n\n\n&gt; Entering new LLMChain chain...\nPrompt after formatting:\nAnswer the following questions as best you can, You have access to the following tools:\nSearch: useful for when you need to ask with search\n\nUse the following format:\nQuestion: the input question you must answer\nThought: you should always think about what to do\nAction: the action to take, should be one of [Search]\nAction Input: the input to the action\nObservation: the result of the action\n... (this Thought/Action/Action Input/Observation can repeat N times)\nThought: I now know the final answer\nFinal Answer: the final answer to the original input question\n\nBegin! \nQuestion: What is hiroko's father's ocupation?\nThought: I need to find out what hiroko's father does for a living.\nAction: Search\nAction Input: \"Hiroko's father's occupation\"\n\nObservation: hiroko's father is takuma\nThought:  I need to find out what Takuma does for a living.\nAction: Search\nAction Input: \"Takuma's occupation\"\n\n\nObservation: takuma is a teacher\nThought: \n\n&gt; Finished chain.\n I now know the final answer.\nFinal Answer: Takuma is a teacher.\n\n\nä»Šå›ã®ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã¯ã¤ãã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒãªãã¦ã€ç›´æ¥Observationã‹ã‚‰Final AnswerãŒå‡ºãŸã®ã§ã€ã“ã‚Œã‚’OutputParserã«æ¸¡ã›ã°AgentFinishã‚’æŠ½å‡ºã§ãã¾ã™ã€‚AgentFinishãŒæŠ½å‡ºã—ãŸæ™‚ç‚¹ã§ã€å…¨ä½“ã®å‡¦ç†ãŒçµ‚ã‚ã‚Šã¾ã™ã€‚\n\naction = parser.parse(third_step_output)\nprint(action)\nprint()\nprint(\"Final Answer:\", action.return_values[\"output\"])\n\nAgentFinish(return_values={'output': 'Takuma is a teacher.'}, log=' I now know the final answer.\\nFinal Answer: Takuma is a teacher.')\n\nFinal Answer: Takuma is a teacher.\n\n\nã“ã‚Œã§ã€Agentã®æœ€åˆã‹ã‚‰æœ€å¾Œã¾ã§ã®æµã‚Œã‚’ã²ã¨é€šã‚Šè§£èª¬ã‚’è¡Œã„ã¾ã—ãŸã€‚"
  },
  {
    "objectID": "posts/20230513_azure_openai/index.html",
    "href": "posts/20230513_azure_openai/index.html",
    "title": "Azure OpenAI Serviceã®åˆ©ç”¨ã«ã¤ã„ã¦",
    "section": "",
    "text": "æœ€è¿‘ã€GPTã‚’ç”¨ã„ãŸææ¡ˆã‚’è¡Œã†éš›ã®ãŠä½œæ³•ã«ã¤ã„ã¦ã„ãã¤ã‹ã®å•ã„åˆã‚ã›ã‚’å—ã‘ã¦ã„ã¾ã™ã€‚å®Ÿã¯ã€ç­†è€…ã‚‚GPTã‚’åˆ©ç”¨ã—ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’æ‹…å½“ã—ã€ã„ãã¤ã‹ã®å•é¡Œã§ã‚³ã‚±ãŸçµŒé¨“ãŒã‚ã‚Šã¾ã™ã€‚ãã®çµŒé¨“ã‚’ã¾ã¨ã‚ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚"
  },
  {
    "objectID": "posts/20230513_azure_openai/index.html#azure-openai-serviceã‚’ä½¿ã†å¿…è¦ãŒã‚ã‚‹",
    "href": "posts/20230513_azure_openai/index.html#azure-openai-serviceã‚’ä½¿ã†å¿…è¦ãŒã‚ã‚‹",
    "title": "Azure OpenAI Serviceã®åˆ©ç”¨ã«ã¤ã„ã¦",
    "section": "Azure OpenAI Serviceã‚’ä½¿ã†å¿…è¦ãŒã‚ã‚‹",
    "text": "Azure OpenAI Serviceã‚’ä½¿ã†å¿…è¦ãŒã‚ã‚‹\nAzure OpenAI Service ã¯ã€ãƒã‚¤ã‚¯ãƒ­ã‚½ãƒ•ãƒˆãŒOpenAIã‚’è²·åã—ãŸå¾Œã€Azureã‚’åŸºç›¤ã¨ã—ã¦æä¾›ã—ã¦ã„ã‚‹OpenAIã®APIã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚Azure OpenAI Serviceã¯ã€OpenAI APIã¨Azureã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºãƒ¬ãƒ™ãƒ«ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã€ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ã€ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã®å¯ç”¨æ€§ã‚’çµ„ã¿åˆã‚ã›ã¦ã„ã¾ã™ã€‚\nã¤ã¾ã‚Šã€Azure OpenAI Serviceã‚’ä½¿ã†ã“ã¨ã§ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¼ç­‰ã®é¢å€’ãªã‚‚ã®ã‚’å…¨éƒ¨Azureã«å§”ã­ã€ã“ã¡ã‚‰ã¯OpenAIã®APIã®åˆ©ç”¨ã«å°‚å¿µã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\nAzure OpenAI Serviceã‚’ä½¿ã†ãŸã‚ã«ã€ã„ãã¤ã‹ã®äº‹å‰æº–å‚™ãŒå¿…è¦ã§ã™ã€‚\nãã®æµã‚Œã¯ä»¥ä¸‹ã§ã™ã€‚éšå±¤æ§‹é€ ã¯å…ˆæ±ºæ¡ä»¶ã‚’æ„å‘³ã—ã¦ã„ã¾ã™ã€‚\nâ†’Azureã‚¢ã‚«ã‚¦ãƒ³ãƒˆç”³è«‹(å³æ—¥)\n    â†’ Azure OpenAI Serviceç”³è«‹ (1ã€œ2æ—¥)\n        â†’ Opt-outç”³è«‹ (2ã€œ4æ—¥)\n        â†’ GPT4ç”³è«‹(ï¼Ÿæ—¥ å¾Œæ—¥è£œè¶³)\n\n\n\n\n\n\nCaution\n\n\n\n()ã®ä¸­ã«ã‚ã‚‹ã®ã¯æ™‚é–“ã®ç›®å®‰ã§ã™ã€‚ã‚ãã¾ã§ã‚‚ç›®å®‰ãªã®ã§ã€ãã†ã¯ãªã‚‰ãªã„å¯èƒ½æ€§ã‚‚ååˆ†ã‚ã‚‹ã“ã¨ã‚’ã”ç†è§£ãã ã•ã„ã€‚\n\n\nå„ç”³è«‹ãƒ•ã‚©ãƒ¼ãƒ ã¯ä»¥ä¸‹ã§ã™ã€‚\n\nAzure OpenAI Serviceç”³è«‹ãƒ•ã‚©ãƒ¼ãƒ \nOpt-outç”³è«‹ãƒ•ã‚©ãƒ¼ãƒ \nGPT4ç”³è«‹ãƒ•ã‚©ãƒ¼ãƒ "
  },
  {
    "objectID": "posts/20230513_azure_openai/index.html#opt-outã¨ã¯",
    "href": "posts/20230513_azure_openai/index.html#opt-outã¨ã¯",
    "title": "Azure OpenAI Serviceã®åˆ©ç”¨ã«ã¤ã„ã¦",
    "section": "Opt-outã¨ã¯",
    "text": "Opt-outã¨ã¯\nä¸€èˆ¬çš„ã«ã€ä¸‹å›³ã®ã‚ˆã†ã«ã€GPTãƒ¢ãƒ‡ãƒ«ã¸ã®ã™ã¹ã¦ã®å…¥åŠ›ã¨å‡ºåŠ›ã¯Azureå´ã§30æ—¥é–“ä¿å­˜ã•ã‚Œã¾ã™ã€‚ã“ã‚Œã¯ã€AzureãŒå€«ç†é•åç­‰ã®ä¸é©åˆ‡ãªè¡Œç‚ºã®æœ‰ç„¡ã‚’å¯©æŸ»ã™ã‚‹ãŸã‚ã®æªç½®ã§ã™ã€‚ãã®ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã‚’ç¦æ­¢ã™ã‚‹ã“ã¨ã¯Opt-outç”³è«‹ã®ç›®çš„ã§ã™ã€‚ è©³ç´°ã¯ã“ã“ã§ç¢ºèªã§ãã¾ã™ã€‚\n\n\n\ndata flow\n\n\n\n\n\n\n\n\nNote\n\n\n\nã“ã®ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã¯ã‚ãã¾ã§ã‚‚å¯©æŸ»ç›®çš„ãªã®ã§ã€Azure OpenAI Serviceã¯é¡§å®¢ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€åˆ‡ãƒ¢ãƒ‡ãƒ«ã®å­¦ç¿’ç­‰ã«åˆ©ç”¨ã—ãªã„ç´„æŸã‚’ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã§æ˜è¨˜ã—ã¦ã„ã¾ã™ã€‚"
  },
  {
    "objectID": "posts/20230513_azure_openai/index.html#å€‹äººæƒ…å ±ã‚’æ‰±ã†å ´åˆ",
    "href": "posts/20230513_azure_openai/index.html#å€‹äººæƒ…å ±ã‚’æ‰±ã†å ´åˆ",
    "title": "Azure OpenAI Serviceã®åˆ©ç”¨ã«ã¤ã„ã¦",
    "section": "å€‹äººæƒ…å ±ã‚’æ‰±ã†å ´åˆ",
    "text": "å€‹äººæƒ…å ±ã‚’æ‰±ã†å ´åˆ\n\n\n\n\n\n\nCaution\n\n\n\n(ç­†è€…ã‚‚æ³•å¾‹ã®ã“ã¨ã¯è©³ã—ããªã„ã®ã§ã€ä»¥ä¸‹ã®è©±ã¯çµŒé¨“ã«éããªãã¦ã€ã‚‚ã£ã¨è‰¯ã„ã‚„ã‚Šæ–¹ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚)\n\n\nAzure OpenAI Serviceç”³è«‹ã™ã‚‹éš›ã«ã€ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã‚’é¸ã¶å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚å€‹äººæƒ…å ±ã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†ã™ã‚‹å ´åˆã¯West Europeã‚’é¸æŠã—ãŸã»ã†ãŒç„¡é›£ã§ã™ã€‚\nãªãœã‹ã©ã„ã†ã¨ã€EUã®GDPRã¯æ—¥æœ¬ã®å€‹äººæƒ…å ±ä¿è­·æ³•ã¨äº’æ›æ€§ãŒã‚ã‚‹ãŸã‚ã€å¥‘ç´„ä¸Šã®æ³•å‹™ä¸Šã®æ‰‹ç¶šããŒã—ã‚„ã™ã„ãŸã‚ã§ã™ã€‚å›½ã®æ©Ÿé–¢ã§ã‚ã‚‹å€‹äººæƒ…å ±ä¿è­·å§”å“¡ä¼šã¯ã€æ—¥EUé–“ãƒ»æ—¥è‹±é–“ã®ãƒ‡ãƒ¼ã‚¿è¶Šå¢ƒç§»è»¢ã«ã¤ã„ã¦ã€ã§ã€æ—¥EUé–“ã®ãƒ‡ãƒ¼ã‚¿è¶Šå¢ƒç§»è»¢ã«ã¤ã„ã¦ä»¥ä¸‹ã®ã‚ˆã†ã«è¿°ã¹ã¦ã„ã¾ã™ã€‚\n\næ—¥EUé–“ã§ã¯ã€ç›¸äº’ã®å††æ»‘ãªå€‹äººãƒ‡ãƒ¼ã‚¿ã®ç§»è»¢ã‚’å›³ã‚‹ç›¸äº’èªè¨¼ã®æ çµ„ã¿ãŒæˆç«‹ã—ã¦ãŠã‚Šã€äº’ã„ã®ãƒ‡ãƒ¼ã‚¿ä¿è­·åˆ¶åº¦ã‚’åŒç­‰ã¨ã¿ãªã—ã€ä¸¡è€…é–“ã§ã®è‡ªç”±ãªå€‹äººãƒ‡ãƒ¼ã‚¿æµé€šãŒå¯èƒ½ã¨ãªã£ã¦ã„ã¾ã™ã€‚\n\nã—ã‹ã—ã€West Europeã‚’ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã¨ã—ã¦é¸æŠã™ã‚‹ã“ã¨ã«ã¯ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã‚‚ã‚ã‚Šã¾ã™ã€‚ãã‚Œã¯æœ€æ–°ã®ãƒ¢ãƒ‡ãƒ«ãŒã™ãã«åˆ©ç”¨ã§ããªã„ã“ã¨ã§ã™ã€‚ä¾‹ãˆã°ã€ç¾æ™‚ç‚¹ã§ã¯GPT4ã¯ã¾ã West Europeã§åˆ©ç”¨ã§ãã¾ã›ã‚“ã€‚ã“ã‚Œã‹ã‚‰æ–°ã—ã„ãƒ¢ãƒ‡ãƒ«ãŒå‡ºã¦ã‚‚ã€ãã‚ŒãŒWest Europeã§é©ç”¨ã•ã‚Œã‚‹ã¾ã§ã«æ™‚é–“ãŒã‹ã‹ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚\n\n\n\n\n\n\nNote\n\n\n\nAzureã®æ‹…å½“è€…ã«ãƒªãƒ¼ã‚¸ãƒ§ãƒ³å•é¡Œã«ã¤ã„ã¦å•ã„åˆã‚ã›ãŸã¨ã“ã‚ã€ã€Œã©ã®ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã§ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ã‚‚ã€Azure OpenAI Serviceã¯GDPRã«æº–æ‹ ã—ã¦ã„ã¾ã™ã€ã¨ã®å›ç­”ã‚’å¾—ã¾ã—ãŸã€‚ ã“ã®ãƒšãƒ¼ã‚¸ã§åŒã˜å›ç­”ã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã‚¢ãƒ¡ãƒªã‚«ã«è¨­å®šã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ãŸã ã—ã€ã‚¢ãƒ¡ãƒªã‚«ã‚’é¸ã¶å ´åˆã«ã¯ã€ã•ã‚‰ãªã‚‹èª¿æŸ»ãŒå¿…è¦ã§ã™ã€‚"
  },
  {
    "objectID": "posts/20230505_LangChain_basic/index.html",
    "href": "posts/20230505_LangChain_basic/index.html",
    "title": "LangChainã®ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ã‚’å…¨é¢è§£èª¬ã™ã‚‹",
    "section": "",
    "text": "OpenAIã®GPTã®APIã‚’åˆ©ç”¨ã—ã¦ã‚¢ãƒ—ãƒªã‚’ä½œæˆã™ã‚‹ã«ã¯ã€ä»Šã¾ã§ä¸€ç•ªä½¿ã„ã‚„ã™ã„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯LangChainğŸ¦œï¸ğŸ”— ã ã¨æ€ã„ã¾ã™ã€‚æœ¬æ–‡ã§ã¯ã€LangChainã®åŸºæœ¬çš„ãªä½¿ã„æ–¹ã‚’å„ªã—ãèª¬æ˜ã—ã¾ã™ã€‚\n\n\n\nLangChain"
  },
  {
    "objectID": "posts/20230505_LangChain_basic/index.html#å‰æ›¸ã",
    "href": "posts/20230505_LangChain_basic/index.html#å‰æ›¸ã",
    "title": "LangChainã®ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ã‚’å…¨é¢è§£èª¬ã™ã‚‹",
    "section": "",
    "text": "OpenAIã®GPTã®APIã‚’åˆ©ç”¨ã—ã¦ã‚¢ãƒ—ãƒªã‚’ä½œæˆã™ã‚‹ã«ã¯ã€ä»Šã¾ã§ä¸€ç•ªä½¿ã„ã‚„ã™ã„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯LangChainğŸ¦œï¸ğŸ”— ã ã¨æ€ã„ã¾ã™ã€‚æœ¬æ–‡ã§ã¯ã€LangChainã®åŸºæœ¬çš„ãªä½¿ã„æ–¹ã‚’å„ªã—ãèª¬æ˜ã—ã¾ã™ã€‚\n\n\n\nLangChain"
  },
  {
    "objectID": "posts/20230505_LangChain_basic/index.html#ç’°å¢ƒè¨­å®š",
    "href": "posts/20230505_LangChain_basic/index.html#ç’°å¢ƒè¨­å®š",
    "title": "LangChainã®ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ã‚’å…¨é¢è§£èª¬ã™ã‚‹",
    "section": "ç’°å¢ƒè¨­å®š",
    "text": "ç’°å¢ƒè¨­å®š\nã¾ãšã¯å®šç•ªã®pipã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã“ã¨ã§ã™ã€‚\npip install langchain, openai\nãã®ã¤ãã«ã€OpenAIã®APIã‚­ãƒ¼ã‚’å–å¾—ã—ã¦ã€ç’°å¢ƒå¤‰æ•°ã«è¨­å®šã—ã¾ã™ã€‚ APIã¯ã“ã“ã‹ã‚‰å–å¾—ã§ãã¾ã™ã€‚\nimport os\nos.environ[\"OPENAI_API_KEY\"] = \"...\"\nç›´æ¥ã«APIã‚­ãƒ¼ã‚’æ›¸ãã®ã¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®å•é¡ŒãŒã‚ã‚‹ã®ã§ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å…±æœ‰ã™ã‚‹å ´åˆã¯(ä¾‹ãˆã°æœ¬æ–‡)ã€APIã‚­ãƒ¼ã‚’åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã—ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰èª­ã¿è¾¼ã‚“ã ã»ã†ãŒã‚ˆã„ã§ã™ã€‚\n\nimport os \nwith open(\"../../.env\", \"r\") as f: \n    os.environ.update(dict([line.strip().split(\"=\") for line in f.readlines()]))"
  },
  {
    "objectID": "posts/20230505_LangChain_basic/index.html#openaiã®gptãƒ¢ãƒ‡ãƒ«",
    "href": "posts/20230505_LangChain_basic/index.html#openaiã®gptãƒ¢ãƒ‡ãƒ«",
    "title": "LangChainã®ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ã‚’å…¨é¢è§£èª¬ã™ã‚‹",
    "section": "OpenAIã®GPTãƒ¢ãƒ‡ãƒ«",
    "text": "OpenAIã®GPTãƒ¢ãƒ‡ãƒ«\nLangChainã®ä¸­ã«OpenAIã®GPTãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ã†ãƒ©ãƒƒãƒ‘ãƒ¼ãŒã‚ã‚Šã¾ã™ã€‚ç¾åœ¨ä½¿ãˆã‚‹ãƒ¢ãƒ‡ãƒ«ã¯ãƒ†ã‚­ã‚¹ãƒˆè£œå®Œãƒ¢ãƒ‡ãƒ«ã¨Chatãƒ¢ãƒ‡ãƒ«ã®2ç¨®é¡ã‚ã‚Šã¾ã™ã€‚ç”Ÿæˆãƒ¢ãƒ‡ãƒ«ã®å ´åˆã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ä½¿ã„ã¾ã™ã€‚\n\nfrom langchain.llms import OpenAI\nllm = OpenAI(temperature=0)\noutput = llm(\"æ—¥æœ¬ã®é¦–éƒ½ã¯?\")\nprint(output.strip())\n\næ±äº¬ã§ã™ã€‚\n\n\nã¾ãŸã€Chatãƒ¢ãƒ‡ãƒ«ã‚’åˆ©ç”¨ã—ã¦å¯¾è©±ã‚’è¡Œã†ã“ã¨ã‚‚ã§ãã¾ã™ã€‚\n\nfrom langchain.chat_models import ChatOpenAI\nfrom langchain.schema import (\n    AIMessage,\n    HumanMessage,\n    SystemMessage\n)\n\nchat = ChatOpenAI(temperature=0)\noutput = chat([HumanMessage(content=\"æ–‡æ³•ã‚’ä¿®æ­£ã—ã¦ãã ã•ã„:I loves programming.\")])\nprint(output.content)\n\nI love programming.\n\n\n\nå„ãƒ¢ãƒ‡ãƒ«ã®ç‰¹æ€§ã®ã¾ã¨ã‚\nå„ãƒ¢ãƒ‡ãƒ«ã®å€¤æ®µã‚„ã€æœ€å¤§ãƒˆãƒ¼ã‚¯ãƒ³æ•°ã€ãƒ¢ãƒ‡ãƒ«ã‚µã‚¤ã‚ºã¯ä»¥ä¸‹ã®è¡¨ã«ã¾ã¨ã‚ã¾ã—ãŸã€‚\nãƒ†ã‚­ã‚¹ãƒˆè£œå®Œãƒ¢ãƒ‡ãƒ«\n\n\n\n\nãƒ¢ãƒ‡ãƒ«å\n\n\nå€¤æ®µ(1k tokensã”ã¨)\n\n\næœ€å¤§ãƒˆãƒ¼ã‚¯ãƒ³æ•°\n\n\nãƒ¢ãƒ‡ãƒ«ã‚µã‚¤ã‚º(æ¨æ¸¬)\n\n\n\n\nDavinci\n\n\n$0.0200\n\n\n4,097\n\n\n175B\n\n\n\n\nCurie\n\n\n$0.0020\n\n\n4,097\n\n\n6.7B\n\n\n\n\nBabbage\n\n\n$0.0005\n\n\n4,097\n\n\n1.3B\n\n\n\n\nAda\n\n\n$0.0004\n\n\n4,097\n\n\n350M\n\n\n\n\nChatãƒ¢ãƒ‡ãƒ«\n\n\n\n\nãƒ¢ãƒ‡ãƒ«å\n\n\nå€¤æ®µ(**Prompt)\n\n\nå€¤æ®µ(**è£œå®Œ)\n\n\næœ€å¤§ãƒˆãƒ¼ã‚¯ãƒ³æ•°\n\n\nãƒ¢ãƒ‡ãƒ«ã‚µã‚¤ã‚º(æ¨æ¸¬)\n\n\n\n\ngpt-3.5-turbo\n\n\n$0.002\n\n\n$0.002\n\n\n4,096\n\n\n6.7B\n\n\n\n\ngpt-4\n\n\n$0.03\n\n\n$0.06\n\n\n8,192\n\n\n6.7B\n\n\n\n\ngpt-4-32k\n\n\n$0.06\n\n\n$0.12\n\n\n32,768\n\n\n1.3B\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nã“ã“ã§æ³¨æ„ã™ã‚‹ã“ã¨ã¨ã—ã¦ã¯GPT4ã®å€¤æ®µã§ã™ã€‚ã‚¤ãƒ³ãƒ—ãƒƒãƒˆã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆãŒpromptã€ç”Ÿæˆã—ãŸãƒ†ã‚­ã‚¹ãƒˆã¯completionã«åˆ†ã‹ã‚Œã¦ã„ã¦ã€promptã®å€¤æ®µã¨completionã®å€¤æ®µã‚’è¶³ã—ãŸã‚‚ã®ãŒGPT4ã®å€¤æ®µã«ãªã‚Šã¾ã™ã€‚\n\n\n\n\nãƒ¢ãƒ‡ãƒ«ã®ä½¿ã„åˆ†ã‘\nãƒ¢ãƒ‡ãƒ«ã®ä½¿ã„åˆ†ã‘ã«ã¤ã„ã¦ã¯ã€æœ€ã‚‚ä½¿ã‚ã‚Œã¦ã„ã‚‹ã®ã¯Chatãƒ¢ãƒ‡ãƒ«ã®gpt-3.5-turboã¨gpt-4ã§ã™ã€‚gpt-3.5-turboã¯ãƒ¢ãƒ‡ãƒ«ã®ã‚µã‚¤ã‚ºãŒå°ã•ã„ã®ã§ã€ç”Ÿæˆæ™‚é–“ãŒçŸ­ãã€å€¤æ®µã‚‚å®‰ã„ã§ã™ã€‚ä¸€æ–¹ã€gpt-4ã¯æ€§èƒ½ãŒè‰¯ã„ã®ã§ã€æ€§èƒ½ã‚’æ±‚ã‚ã‚‹å ´åˆã¯gpt-4ã®ã»ã†ãŒè‰¯ã„ã§ã™ã€‚ã¾ãŸã€gpt-4ã®æœ€å¤§ãƒˆãƒ¼ã‚¯ãƒ³æ•°ãŒ8Kã«ãªã£ã¦ã„ã‚‹ã®ã§ã€ç”Ÿæˆã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆã®é•·ã•ãŒé•·ã„å ´åˆã‚‚ã“ã¡ã‚‰ã‚’ä½¿ã†ã»ã†ãŒã„ã„ã§ã™ã€‚\nä»–ã®ãƒ¢ãƒ‡ãƒ«ã¯ã»ã¨ã‚“ã©ä½¿ã‚ã‚Œãªã„ã®ã§ã€å¿…è¦ã«å¿œã˜ã¦è©³ç´°ã‚’è¦‹ã‚Œã°è‰¯ã„ã§ã™ã€‚\n\n\nTokenã®è¨ˆç®—æ–¹æ³•\nTokenã®è¨ˆç®—æ–¹æ³•ã«ã¤ã„ã¦ã¯ã€ã“ã¡ã‚‰ã§ç´¹ä»‹ã—ãŸã®ã§ã€æœ¬æ–‡ã§ã¯å‰²æ„›ã—ã¾ã™ã€‚è¦ã™ã‚‹ã«ã€æ—¥æœ¬èªåƒæ–‡å­—ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ãŠãŠã‚ˆã1,000ãƒˆãƒ¼ã‚¯ãƒ³ã«ãªã‚Šã€ãã‚Œã‚’å‡¦ç†ã™ã‚‹ã«ã¯gpt-3.5-turboã®å ´åˆã¯æ¦‚ç®—ã§0.59å††ã€gpt-4ã®å ´åˆã¯æ¦‚ç®—ã§$9.7å††ã‹ã‹ã‚Šã¾ã™ã€‚"
  },
  {
    "objectID": "posts/20230505_LangChain_basic/index.html#prompt-template",
    "href": "posts/20230505_LangChain_basic/index.html#prompt-template",
    "title": "LangChainã®ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ã‚’å…¨é¢è§£èª¬ã™ã‚‹",
    "section": "Prompt Template",
    "text": "Prompt Template\nLangChainã®Prompt Templateã¯Promptã‚’ç°¡å˜ã«ä½œæˆã™ã‚‹ãŸã‚ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã™ã€‚Example selectorä»˜ãã®Promptã‚’ä½œã‚‹ã«ã¯ã¨ã¦ã‚‚å½¹ã«ç«‹ã¡ã¾ã™ã€‚ã§ã‚‚ãã‚Œã¯ã‚ˆã‚Šã‚¢ãƒ‰ãƒãƒ³ã‚¹çš„ãªã‚„ã‚Šæ–¹ãªã®ã§ã€å…¥é–€ã®æ®µéšã§ã¯å˜ç´”ã«Pythonã®f-stringã¨ã—ã¦ä½¿ãˆã‚Œã°è‰¯ã„ã§ã™ã€‚\nPromptã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’æ›¸ã„ãŸå¾Œã€ãã‚Œã‚’PromptTemplateã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«æ¸¡ã—ã¦ã€PromptTemplateã®formatãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™ã¨ã€PromptãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚\n\nfrom langchain import PromptTemplate\n\ntemplate = \"ç§ã¯{fruit}ãŒå¥½ãã§ã™ã€‚\"\nprompt_template = PromptTemplate.from_template(template)\nprint(prompt_template.format(fruit=\"ã‚Šã‚“ã”\"))\nprint(prompt_template.format(fruit=\"ã¿ã‹ã‚“\"))\n\nç§ã¯ã‚Šã‚“ã”ãŒå¥½ãã§ã™ã€‚\nç§ã¯ã¿ã‹ã‚“ãŒå¥½ãã§ã™ã€‚"
  },
  {
    "objectID": "posts/20230505_LangChain_basic/index.html#vectorstore",
    "href": "posts/20230505_LangChain_basic/index.html#vectorstore",
    "title": "LangChainã®ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ã‚’å…¨é¢è§£èª¬ã™ã‚‹",
    "section": "VectorStore",
    "text": "VectorStore\nãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ¤œç´¢ã™ã‚‹ãŸã‚ã«ã¯ã€VectorStoreã‚’ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚VectorStoreã¯ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ãƒªã‚¹ãƒˆã‚’å—ã‘å–ã£ã¦ã€ãã‚Œã‚’ãƒ™ã‚¯ãƒˆãƒ«ã«å¤‰æ›ã—ã¦ä¿å­˜ã—ã¾ã™ã€‚æ¤œç´¢ã™ã‚‹éš›ã«ã€æ¤œç´¢ã‚¯ã‚¨ãƒªã‚’ãƒ™ã‚¯ãƒˆãƒ«ã«å¤‰æ›ã—ã¦ã€ãƒ™ã‚¯ãƒˆãƒ«ã®é¡ä¼¼åº¦ã‚’è¨ˆç®—ã—ã¦ã€é¡ä¼¼åº¦ãŒé«˜ã„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è¿”ã—ã¾ã™ã€‚\n\n\n\n\n\n\nFAISSã«ã¤ã„ã¦\n\n\n\nFAISSã¯MetaãŒé–‹ç™ºã—ãŸé«˜é€Ÿãªé¡ä¼¼æ€§æ¤œç´¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚Faissã¯ã€å¤§é‡ã®ãƒ™ã‚¯ãƒˆãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’æ ¼ç´ã—ã€é«˜é€Ÿãªæ¤œç´¢ã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚\n\n\n\nfrom langchain.document_loaders import TextLoader\nfrom langchain.indexes import VectorstoreIndexCreator\nfrom langchain.vectorstores import FAISS\n# create test data\nwith open(\"./test_data.txt\", \"w\") as f:\n    fruits = [\"ã‚Šã‚“ã”\", \"ã¿ã‹ã‚“\", \"ãƒãƒŠãƒŠ\", \"ãƒ‘ã‚¤ãƒŠãƒƒãƒ—ãƒ«\", \"ã¶ã©ã†\"]\n    for fruit in fruits:\n        f.write(f\"ç§ã¯{fruit}ãŒå¥½ãã§ã™ã€‚\\n\")\n        \n# load test data\nloader = TextLoader('./test_data.txt', encoding='utf8')\n\n# query test data\nindex = VectorstoreIndexCreator(vectorstore_cls=FAISS).from_loaders([loader])\nindex.query(\"ã‚Šã‚“ã”\")\n\n' ç§ã¯ã‚Šã‚“ã”ãŒå¥½ãã§ã™ã€‚'"
  },
  {
    "objectID": "posts/20230505_LangChain_basic/index.html#chain",
    "href": "posts/20230505_LangChain_basic/index.html#chain",
    "title": "LangChainã®ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ã‚’å…¨é¢è§£èª¬ã™ã‚‹",
    "section": "Chain",
    "text": "Chain\nChainã¯LangChainã®ä¸­å¿ƒçš„ãªæ¦‚å¿µã§ã™ã€‚ä»Šã¾ã§ç´¹ä»‹ã—ãŸè¤‡æ•°ã®éƒ¨å“ã‚’çµ„ã¿åˆã‚ã›ã§Chainã‚’ä½œã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã‚¤ãƒ³ãƒ—ãƒƒãƒˆãŒå…¥åŠ›ã•ã‚ŒãŸå¾Œã€Chainã®å†…éƒ¨ã§å‡¦ç†ã—ã€ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã‚’å‡ºã™ã€‚\nä¾‹ãˆã°ã€PromptTemplateã¨LLMã‚’ã¤ãªãChainã‚’ä½œã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚PromptTemplateã¯Promptã‚’ç”Ÿæˆã™ã‚‹ã®ã§ã€LLMã®ã‚¤ãƒ³ãƒ—ãƒƒãƒˆã«ãªã‚Šã¾ã™ã€‚LLMã¯Promptã‚’å—ã‘å–ã£ã¦ã€ãã‚Œã‚’è£œå®Œã—ã¦ã€ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã‚’ç”Ÿæˆã—ã¾ã™ã€‚ã“ã†ã—ã¦PromptTemplateã¨LLMã‚’ã¤ãªãChainã‚’ä½œã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\n\n\n\n\nflowchart LR\n    Input([Input])--&gt;PromptTemplate\n    LLM--&gt;Output([Output])\n    subgraph Chain\n    PromptTemplate--&gt;formattedPrompt([Formatted Prompt])\n    formattedPrompt--&gt;LLM\n    end\n    style PromptTemplate stroke:#333,stroke-width:4px\n    style LLM stroke:#333,stroke-width:4px\n\n\nChainã®ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ã®ä¾‹\n\n\n\n\nfrom langchain.prompts import PromptTemplate\nfrom langchain.llms import OpenAI\nfrom langchain.chains import LLMChain\nllm = OpenAI(temperature=0.9)\nprompt = PromptTemplate.from_template(\"{country}ã®é¦–éƒ½ã¯ä½•ã§ã™ã‹ï¼Ÿ\")\nchain = LLMChain(llm=llm, prompt=prompt)\n\nã“ã‚Œã§å„å›½ã®é¦–éƒ½ã¯ç°¡å˜ã«æ¤œç´¢ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚\n\nprint(chain.run({\"country\": \"æ—¥æœ¬\"}).strip())\nprint(chain.run({\"country\": \"ã‚¢ãƒ¡ãƒªã‚«\"}).strip())\n\næ±äº¬ã§ã™ã€‚\nãƒ¯ã‚·ãƒ³ãƒˆãƒ³D.C."
  },
  {
    "objectID": "posts/20230505_LangChain_basic/index.html#agent",
    "href": "posts/20230505_LangChain_basic/index.html#agent",
    "title": "LangChainã®ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ã‚’å…¨é¢è§£èª¬ã™ã‚‹",
    "section": "Agent",
    "text": "Agent\nAgentã¯Chainã‚ˆã‚Šã‚‚é«˜ã„ãƒ¬ãƒ™ãƒ«ã®æ¦‚å¿µã§ã™ã€‚Agentã¯ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã†ã“ã¨ãŒã§ãã¾ã™ã€‚ãã‚Œã«ã‚ˆã‚Šã€Agentã¯å†…éƒ¨ç’°å¢ƒã«ã¨ã©ã¾ã‚‰ãšã€å¤–éƒ¨ç’°å¢ƒã¨ã‚‚ã‚„ã‚Šå–ã‚Šã§ãã¾ã™ã€‚\nä¸€ç•ªã‚·ãƒ³ãƒ—ãƒ«ã®ä¾‹ã¨ã—ã¦ã¯BingChatãŒã‚ã’ã‚‰ã‚Œã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¯ã‚¨ãƒªãƒ¼ã‚’å—ã‘ãŸå¾Œã€BingChatã¯ã‚¤ãƒ³ã‚¿ãƒãƒƒãƒˆã‹ã‚‰æƒ…å ±ã‚’æ¤œç´¢ã—ã€ãã‚Œã‚’ã‚µãƒãƒªãƒ¼ã—ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¯ã‚¨ãƒªã«ç­”ãˆã¾ã™ã€‚\nAgentã®ä¸­èº«ã¯è¤‡é›‘ã§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«æ›¸ã„ã¦ã„ãªã„ã®ã§ã€ä»Šå›ã¯æŒ™å‹•ã ã‘è¦‹ã›ã¾ã™ã€‚ã“ã“ã§BingChatã«ä¼¼ã¦ã„ã‚‹æ©Ÿèƒ½ã‚’å®Ÿç¾ã™ã‚‹Agentã‚’ä½œã‚Šã¾ã™ã€‚ã“ã®Agentã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¯ã‚¨ãƒªãƒ¼ã‚’å—ã‘å–ã£ã¦ã€ãã‚Œã‚’ã‚¤ãƒ³ã‚¿ãƒãƒƒãƒˆã§æ¤œç´¢ã—ã€ãã®ç­”ãˆã‚’è¿”ã™ã“ã¨ãŒã§ãã¾ã™ã€‚ã¾ãŸã€å¤–éƒ¨ã®é›»å“ãƒ„ãƒ¼ãƒ«ã‚’åˆ©ç”¨ã—ã¦è¨ˆç®—ã‚‚ã§ãã¾ã™ã€‚\n\nfrom langchain.agents import load_tools\nfrom langchain.agents import initialize_agent\nfrom langchain.agents import AgentType\nfrom langchain.llms import OpenAI\n\nllm = OpenAI(temperature=0)\ntools = load_tools([\"serpapi\", \"llm-math\"], llm=llm)\nagent = initialize_agent(tools, llm, agent=AgentType.ZERO_SHOT_REACT_DESCRIPTION, verbose=True)\n\n\nagent.run(\"ä»Šæ—¥ã®æ°—æ¸©ã¯ä½•åº¦ã§ã™ã‹ï¼Ÿãã®2ä¹—ã¯ä½•ã§ã™ã‹ï¼Ÿ\")\n\n\n\n&gt; Entering new AgentExecutor chain...\n I need to find out the temperature and then calculate its square.\nAction: Search\nAction Input: ä»Šæ—¥ã®æ°—æ¸©\nObservation: ãƒ‹ãƒ¥ãƒ¼ãƒ¨ãƒ¼ã‚¯, NY, ã‚¢ãƒ¡ãƒªã‚«åˆè¡†å›½ ã®å¤©æ°—. 4. ä»Šæ—¥ Â· 1æ™‚é–“ã”ã¨ Â· 10æ—¥é–“ Â· ãƒ¬ãƒ¼ãƒ€ãƒ¼. 1æ™‚é–“ã”ã¨ã®å¤©æ°—-ãƒ‹ãƒ¥ãƒ¼ãƒ¨ãƒ¼ã‚¯, NY, ã‚¢ãƒ¡ãƒªã‚«åˆè¡†å›½. 13:48 EDTæ™‚ç‚¹ ...\nThought: I need to find the temperature from the search results\nAction: Search\nAction Input: ä»Šæ—¥ã®æ°—æ¸© ãƒ‹ãƒ¥ãƒ¼ãƒ¨ãƒ¼ã‚¯\nObservation: 16:00 Â· ä½“æ„Ÿæ¸©åº¦16Â° Â· é¢¨å—æ± 8 km/h Â· æ¹¿åº¦47% Â· ç´«å¤–ç·šæŒ‡æ•°2/10 Â· é›²é‡78% Â· é›¨é‡0 cm ...\nThought: I now have the temperature, I need to calculate its square\nAction: Calculator\nAction Input: 16^2\nObservation: Answer: 256\nThought: I now know the final answer\nFinal Answer: ä»Šæ—¥ã®æ°—æ¸©ã¯16åº¦ã§ã€ãã®2ä¹—ã¯256ã§ã™ã€‚\n\n&gt; Finished chain.\n\n\n'ä»Šæ—¥ã®æ°—æ¸©ã¯16åº¦ã§ã€ãã®2ä¹—ã¯256ã§ã™ã€‚'\n\n\nã€Œä»Šæ—¥ã®æ°—æ¸©ã¯ä½•åº¦ã§ã™ã‹ï¼Ÿãã®2ä¹—ã¯ä½•ã§ã™ã‹ï¼Ÿã€ã®ã‚¯ã‚¨ãƒªãƒ¼ã‚’æŠ•ã’ãŸå¾Œã€Agentã®ã»ã†ã¯ã¾ãšã‚„ã‚‹ã¹ãã“ã¨ã‚’æ±ºã‚ã¾ã—ãŸã€‚ã‚„ã‚‹ã¹ãã“ã¨ã‚’ãƒ—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ã—ãªãŒã‚‰ã€è‡ªåˆ†ãŒæŒã£ã¦ã„ã‚‹ãƒ„ãƒ¼ãƒ«ã‚’é§†ä½¿ã—ã€ã‚¯ã‚¨ãƒªãƒ¼ã«ç­”ãˆã¾ã—ãŸã€‚"
  },
  {
    "objectID": "posts/20230505_LangChain_basic/index.html#ã¾ã¨ã‚",
    "href": "posts/20230505_LangChain_basic/index.html#ã¾ã¨ã‚",
    "title": "LangChainã®ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ã‚’å…¨é¢è§£èª¬ã™ã‚‹",
    "section": "ã¾ã¨ã‚",
    "text": "ã¾ã¨ã‚\nã“ã‚Œã§LangChainã®ä¸­ã«ã‚ã‚‹Memoryä»¥å¤–ã®ã‚‚ã®ã‚’ã²ã¨é€šã‚Šæµ…ãç´¹ä»‹ã—ã¾ã—ãŸã€‚LangChainã®é–‹ç™ºã¯ã¾ã åˆæœŸã®æ®µéšãªã®ã§ã€APIã®è¨­è¨ˆã‚„ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®å……å®Ÿã•ãªã©ã®å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚ä»Šå¾Œã¯å„æ¦‚å¿µã‚’è§£å‰–ã™ã‚‹è¨˜äº‹ã‚’æ›¸ã„ã¦ã„ãã¾ã™ã€‚"
  },
  {
    "objectID": "posts/20230430_HyDE/index.html",
    "href": "posts/20230430_HyDE/index.html",
    "title": "HyDE è«–æ–‡è§£èª­",
    "section": "",
    "text": "HyDEè«–æ–‡ã§ã¯ã€æ•™å¸«ãªã—ã®Zero-shot dense retrievalã‚·ã‚¹ãƒ†ãƒ ã‚’ææ¡ˆã€‚å¾“æ¥ã®Dense retrieverã¨ã¯ç•°ãªã‚Šã€HyDEã¯Queryã‹ã‚‰ä»®æƒ³çš„ãªDocumentã‚’ç”Ÿæˆã—ã€ãã®é¡ä¼¼åº¦ã§ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã€‚InstructGPTã§ä»®æƒ³ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ç”Ÿæˆã—ã€Contrieverã‚’ä½¿ã£ã¦Embeddingã«å¤‰æ›ã€‚æ§˜ã€…ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ãƒ†ã‚¹ãƒˆã—ãŸçµæœã€HyDEã¯æ•™å¸«ãªã—é ˜åŸŸã§å¾“æ¥ã®Contrieverã‚’å‡Œé§•ã—ã€æ•™å¸«ã‚ã‚Šãƒ¢ãƒ‡ãƒ«ã¨ã‚‚éœè‰²ãªã„ç²¾åº¦ã‚’ç¤ºã—ãŸã€‚å®Ÿè£…ã¯LangChainã§åˆ©ç”¨å¯èƒ½ã€‚\nè«–æ–‡URLï¼šhttps://arxiv.org/abs/2204.07496"
  },
  {
    "objectID": "posts/20230430_HyDE/index.html#related-works",
    "href": "posts/20230430_HyDE/index.html#related-works",
    "title": "HyDE è«–æ–‡è§£èª­",
    "section": "2 Related works",
    "text": "2 Related works"
  },
  {
    "objectID": "posts/20230430_HyDE/index.html#methology",
    "href": "posts/20230430_HyDE/index.html#methology",
    "title": "HyDE è«–æ–‡è§£èª­",
    "section": "3 Methology",
    "text": "3 Methology"
  },
  {
    "objectID": "posts/20230430_HyDE/index.html#experiments",
    "href": "posts/20230430_HyDE/index.html#experiments",
    "title": "HyDE è«–æ–‡è§£èª­",
    "section": "4 Experiments",
    "text": "4 Experiments\nä»®æƒ³ãªDocumentã¯InstructGPTã§ç”Ÿæˆã—ãŸã€‚ç”Ÿæˆã—ãŸDocumentã‚’Contrieverã‚’ç”¨ã„ã¦Embeddingã«å¤‰æ›ã—ãŸã€‚\nãƒ†ã‚¹ãƒˆã®ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ã¯ã€MS-MARCOã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ãŸTREC DL19 DL20ãŒã‚ã‚Šã€BEIRã‹ã‚‰ã‚‚Low-resourceã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ã„ãã¤åˆ©ç”¨ã—ãŸã€‚ã¾ãŸã€è‹±èªä»¥å¤–ã€éŸ“å›½èªã€æ—¥æœ¬èªç­‰ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚‚ä½¿ã£ãŸã€‚\n\n\n\nweb search query sets\n\n\n\n\n\nlow-resource datasets\n\n\n\n\n\nnon-English retrieval\n\n\nçµæœã‚’è¦‹ã‚‹ã¨ã€æ•™å¸«ãªã—ã®é ˜åŸŸã§HyDEã¯å…¨é¢çš„ã«ä»¥å‰ã®Contrieverã‚’è¶…ãˆãŸã€‚ã¾ãŸã€æ•™å¸«ã‚ã‚‹ã®ãƒ¢ãƒ‡ãƒ«ã‹ã‚‰æ¯”è¼ƒã—ã¦ã‚‚éœè‰²ã—ãªã„ç²¾åº¦ã‚’å‡ºã—ãŸã€‚"
  },
  {
    "objectID": "posts/20230430_HyDE/index.html#analysis",
    "href": "posts/20230430_HyDE/index.html#analysis",
    "title": "HyDE è«–æ–‡è§£èª­",
    "section": "5 Analysis",
    "text": "5 Analysis\n\n\n\nLLM difference\n\n\nå½“ãŸã‚Šå‰ã ãŒã€ä»®æƒ³ãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ç”Ÿæˆã™ã‚‹LLMã«ã‚ˆã£ã¦æœ€çµ‚ã®ç²¾åº¦ãŒé•ã†ã€‚ã¾ãŸã€HyDEã¯æ•™å¸«ãªã—ã®æ‰‹æ³•ã ãŒã€æ•™å¸«ã‚ã‚Šã®Retrieverã®ç²¾åº¦ã‚‚å‘ä¸Šã§ãã‚‹ã€‚"
  },
  {
    "objectID": "posts/20230430_HyDE/index.html#å®Ÿè£…",
    "href": "posts/20230430_HyDE/index.html#å®Ÿè£…",
    "title": "HyDE è«–æ–‡è§£èª­",
    "section": "å®Ÿè£…",
    "text": "å®Ÿè£…\nHyDEã¯ã™ã§ã«LangChainã§å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ã€‚\nfrom langchain.llms import OpenAI\nfrom langchain.embeddings import OpenAIEmbeddings\nfrom langchain.chains import HypotheticalDocumentEmbedder\n\nbase_embeddings = OpenAIEmbeddings()\nllm = OpenAI()\n\n# Load with `web_search` prompt\nembeddings = HypotheticalDocumentEmbedder.from_llm(llm, base_embeddings, \"web_search\")\n\n# Now we can use it as any embedding class!\nresult = embeddings.embed_query(\"Where is the Taj Mahal?\")"
  },
  {
    "objectID": "posts/20230429_promptagator/index.html",
    "href": "posts/20230429_promptagator/index.html",
    "title": "Promptagator è«–æ–‡è§£èª­",
    "section": "",
    "text": "Promptagatorè«–æ–‡ã§ã¯ã€Few-shot Retrieval settingã‚’ææ¡ˆã—ã€ç•°ãªã‚‹æ¤œç´¢ã‚¿ã‚¹ã‚¯ã«å¯¾å¿œã™ã‚‹ãŸã‚ã«å°‚ç”¨ã®Promptã‚’ä½œæˆã—ã¦LLMã§Documentã«é–¢é€£ã™ã‚‹Queryã‚’ç”Ÿæˆã€‚ç”Ÿæˆã•ã‚ŒãŸQueryã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ã€Retrieverã‚’å­¦ç¿’ã•ã›ã‚‹ã€‚å®Ÿé¨“çµæœã‹ã‚‰ã€Promptagatorã¯æ—¢å­˜ã®50ä¸‡ä»¶ä»¥ä¸Šã®å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ãŸãƒ¢ãƒ‡ãƒ«ã‚ˆã‚Šé«˜ã„ç²¾åº¦ã‚’é”æˆã—ã€æ•™å¸«ã‚ã‚Šã®Retrieverã‚ˆã‚Šã‚‚å„ªã‚Œã¦ã„ã‚‹ã“ã¨ãŒåˆ†ã‹ã£ãŸã€‚\nè«–æ–‡URLï¼šhttps://arxiv.org/abs/2209.11755"
  },
  {
    "objectID": "posts/20230429_promptagator/index.html#prompt-base-query-generation",
    "href": "posts/20230429_promptagator/index.html#prompt-base-query-generation",
    "title": "Promptagator è«–æ–‡è§£èª­",
    "section": "3.1 Prompt-base query generation",
    "text": "3.1 Prompt-base query generation\nLLMã¯FLANã‚’åˆ©ç”¨ã—ãŸã€‚Promptã®å½¢å¼ã¨ã—ã¦ã¯ã€HotpotQAã‚’ä¾‹ã¨ã—ã¦èª¬æ˜ã™ã‚‹ã¨ä»¥ä¸‹ã«ãªã‚‹ã€‚\nEvidence: passage 1 \nVexed question: query 1\n...\nEvidence: passage k\nVexed question: query k\nEvidence: target passage\nä¸‹è¡¨ã®ã‚ˆã†ã«ã‚¿ã‚¹ã‚¯ã”ã¨ã«é•ã†Promptã‚’è¨­å®šã—ãŸã€‚ï¼ˆPromptã®ä¸­ã®0ã¨ 1ã®æ„å‘³ãŒä¸æ˜ï¼‰\n\nPromptã§ä½¿ç”¨ã—ãŸä¾‹ã¯æœ€å¤§8å€‹ã«ã—ã€ä¾‹ã®é•·ã•ã«ã‚ˆã£ã¦èª¿æ•´ã—ã¦ã„ã‚‹ã€‚æ–‡æ›¸ãŒé•·ã„å ´åˆã¯ã€å¿…è¦ã«å¿œã˜ã¦åˆ‡æ–­ã—ã¦ã„ã‚‹ã€‚\nå„ã‚³ãƒ¼ãƒ‘ã‚¹ã‹ã‚‰æœ€å¤§100ä¸‡ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æŠ½å‡ºã—ã€å„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§8å€‹ã®Queryã‚’ç”Ÿæˆã—ã¦ã„ã‚‹ã€‚LLMã¯FLAN137Bã‚’ä½¿ã£ãŸã€‚ç”Ÿæˆã™ã‚‹éš›ã«0.7ã®æ¸©åº¦ã‚’ä½¿ã£ãŸã€‚"
  },
  {
    "objectID": "posts/20230429_promptagator/index.html#consistency-filtering-using-only-generated-data",
    "href": "posts/20230429_promptagator/index.html#consistency-filtering-using-only-generated-data",
    "title": "Promptagator è«–æ–‡è§£èª­",
    "section": "3.2 Consistency filtering using only generated data",
    "text": "3.2 Consistency filtering using only generated data\nç”Ÿæˆã—ãŸQueryã«å¯¾ã—ã¦ã€ç”Ÿæˆå…ƒãŒãã®ç­”æ¡ˆã‚’å«ã‚€å¿…è¦ãŒã‚ã‚‹ã€‚ä»Šã¾ã§ã®ç ”ç©¶ã§ã€ãã®åŸå‰‡ã§ç”Ÿæˆã—ãŸQueryã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹ã“ã¨ã¯é‡è¦ã§ã‚ã‚‹ã“ã¨ãŒã—ã‚ã•ã‚Œã¦ã„ã‚‹ã€‚\néå»ã®ç ”ç©¶ã®ä¸­ã§å¤–éƒ¨ã®è³ªå•å¿œç­”ãƒ¢ãƒ‡ãƒ«ã‚’ç”¨ã„ã¦å®Ÿç¾ã—ã¦ã„ãŸãŒã€ã“ã®ç ”ç©¶ã§ã¯ç”Ÿæˆã—ãŸãƒ‡ãƒ¼ã‚¿ã§åˆæœŸã®Retrieverã‚’å­¦ç¿’ã•ã‚Œã¦ã„ã‚‹ã€‚å„ç”Ÿæˆã—ãŸQueryã«å¯¾ã—ã¦ã€RetrieverãŒæ¤œç´¢ã—ãŸTopKã®ä¸­ã«ç”Ÿæˆå…ƒã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒå«ã¾ã‚Œã¦ã„ãªã„å ´åˆã¯ã€ãã®Queryã‚’é™¤å¤–ã™ã‚‹ã€‚"
  },
  {
    "objectID": "posts/20230429_promptagator/index.html#few-shot-promptagator-retriever",
    "href": "posts/20230429_promptagator/index.html#few-shot-promptagator-retriever",
    "title": "Promptagator è«–æ–‡è§£èª­",
    "section": "3.3 Few-shot promptagator retriever",
    "text": "3.3 Few-shot promptagator retriever\nDural Encoderã®Retrieverã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹ã€‚ãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«ã¯T5ã§ã€ãã‚Œã‚’C4ï¼ˆCommon Crawlã®web crawlã‚³ãƒ¼ãƒ‘ã‚¹ï¼‰ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ä½¿ã£ã¦ã€ContriverãŒä½¿ç”¨ã—ãŸindependent cropping taskã§ã•ã‚‰ã«å­¦ç¿’ã•ã›ãŸã€‚ï¼ˆindependent cropping taskã¨ã¯ã€åŒã˜æ–‡æ›¸ã®ç•°ãªã‚‹éƒ¨åˆ†ã®ãƒšã‚¢ã‚’Positive exampleã€ç•°ãªã‚‹æ–‡æ›¸ã®ãƒ†ã‚­ã‚¹ãƒˆã®ãƒšã‚¢ã‚’Negative exampleã¨ã—ã¦ã€æ•™å¸«ãªã—ã§Retrieverã‚’å­¦ç¿’ã™ã‚‹æ‰‹æ³•ï¼‰\nãã®å¾Œã€ç”Ÿæˆã•ã‚ŒãŸQueryã¨Documentã®ãƒšã‚¢ã‚’ä½¿ã£ã¦ç¶™ç¶šçš„ã«å­¦ç¿’ã•ã›ã‚‹ã€‚å­¦ç¿’æ™‚ã«Batchå†…ã®Queryã¨Documentã®ãƒšã‚¢ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã—ã¦Negative exampleã¨ã™ã‚‹ã€‚ã¾ãŸã€ä¸€å®šã®Stepæ•°ã‚’å­¦ç¿’ã—ãŸå¾Œã€ãã‚Œã‚’åˆæœŸã®Retrieverã¨ã—ã¦ç”Ÿæˆã•ã‚ŒãŸQueryã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚’è¡Œã†ã€‚ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ãŸå¾Œã€ç¶™ç¶šçš„ã«å­¦ç¿’ã•ã›ã‚‹ã€‚\nã¾ãŸã€Promptagator++ã¨ã„ã†Rerankerã‚‚ææ¡ˆã—ãŸã€‚å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ãŒRetrieverã¨åŒã˜ã ãŒã€ãƒ¢ãƒ‡ãƒ«ã¯ã‚‚ã£ã¨ç²¾åº¦ãŒé«˜ãã€æ¨è«–æ™‚é–“ãŒé•·ã„Cross-attention modelã‚’ä½¿ã£ãŸã€‚Retrieverã‹ã‚‰å–å¾—ã—ãŸä¸Šä½ã®200ä»¶ã®Documentã‹ã‚‰31å€‹ã®Documentã‚’ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã—ã¦ã€Negative exampleã¨ã—ã¦ä½¿ã£ã¦ã„ã‚‹ã€‚"
  },
  {
    "objectID": "posts/20230429_promptagator/index.html#zero-shot-promptagator-retriever",
    "href": "posts/20230429_promptagator/index.html#zero-shot-promptagator-retriever",
    "title": "Promptagator è«–æ–‡è§£èª­",
    "section": "3.4 Zero-shot promptagator retriever",
    "text": "3.4 Zero-shot promptagator retriever\nZero-shotã§Queryã‚’ç”Ÿæˆã™ã‚‹å ´åˆã¯ä»¥ä¸‹ã®å½¢å¼ã§Promptã‚’æ›¸ã„ãŸï¼š\nf'{d} Read the passage and generate a query.'"
  },
  {
    "objectID": "posts/20230429_promptagator/index.html#implementation",
    "href": "posts/20230429_promptagator/index.html#implementation",
    "title": "Promptagator è«–æ–‡è§£èª­",
    "section": "4.1 Implementation",
    "text": "4.1 Implementation\nQueryã‚’ç”Ÿæˆã™ã‚‹éš›ã«æ¸©åº¦ã‚’0.7ã«ã—ãŸã€‚\nç”Ÿæˆã—ãŸQueryã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹éš›ã«Kã‚’1ã«ã—ãŸã€‚\nDual Encodersã¯åŒã˜T5-base v1.1 ã®Encoder(110M)ã‚’ä½¿ã£ã¦ã„ã‚‹ã€‚Encoderã®ãƒˆãƒƒãƒ—ã®å±¤ã‚’å¹³å‡ã—ã€768æ¬¡å…ƒã®Embeddingã¸æŠ•å½±ã—ãŸã€‚\nPromptagator++ã®Rerankerã‚‚T5-base v1.1 ã®Encoder(110M)ã‚’ä½¿ã£ã¦ã„ã‚‹ãŒã€Cross Attentionã®Encoderã«ã—ã¦ã„ã‚‹ã€‚\nFine-tuningã™ã‚‹éš›ã«ã®å…·ä½“çš„ãªBatch sizeã¨StepsãŒä¸‹è¡¨ã®é€šã‚Šï¼š\n\n\n\nModel type\nDataset size\nBatch size\nFine tune steps\n\n\n\n\nDual encoder\nBig(&gt;500k)\n6k\n5k\n\n\nDual encoder\nSmall(&lt;=500k)\n128\n1k\n\n\nReranker\nBig(&gt;500k)\n64\n20k\n\n\nReranker\nSmall(&lt;=500k)\n64\n5k"
  },
  {
    "objectID": "posts/20230429_promptagator/index.html#main-results",
    "href": "posts/20230429_promptagator/index.html#main-results",
    "title": "Promptagator è«–æ–‡è§£èª­",
    "section": "4.2 Main Results",
    "text": "4.2 Main Results\n\n\n\nMain result\n\n\nè¡¨ã®å‰åŠã§ã¯Retrieverã®æ¯”è¼ƒãŒè¡Œã‚ã‚Œã¦ã„ã‚‹ã€‚Zero-shotã®Promptagatorã¯ã™ã§ã«å¤§å¤šæ•°ã®MS MARCOã§Fine-tuningã—ãŸæ•™å¸«ã‚ã‚Šã®Retrieverã¨åŒç­‰ãªç²¾åº¦ã‚’å‡ºã—ã¦ã„ã‚‹ã€‚Few-shotã®Promptagatorã¯ã•ã‚‰ã«æ•™å¸«ã‚ã‚Šã®Retrieverã‚ˆã‚Šé«˜ã„ç²¾åº¦ã‚’å‡ºã—ã¦ã„ã‚‹ã€‚\nå¾ŒåŠã§ã¯Retriever+Rerankerã®çµ„ã¿åˆã‚ã›ã®æ¯”è¼ƒã«ãªã‚‹ã€‚Retrieverã¨åŒã˜å‚¾å‘ã§ã€Zero-shotã§ã‹ãªã‚Šè‰¯ã„ç²¾åº¦ã‚’å‡ºã—ã¦ã„ã‚‹ã€‚Few-shotã«ãªã‚‹ã¨ã•ã‚‰ã«æ›´ã«ç²¾åº¦ãŒ3%å‘ä¸Šã—ã€Sotaã«ãªã£ã¦ã„ã‚‹ã€‚\nã¾ãŸã€Promptagatorã®ã‚‚ã†ä¸€ã¤å„ªã‚Œã¦ã„ã‚‹ç‚¹ã¯ãƒ¢ãƒ‡ãƒ«ã®ã‚µã‚¤ã‚ºã§ã‚ã‚‹ã€‚ä»–ã®ãƒ¢ãƒ‡ãƒ«ã¯å¤§ä½“3Bã®å¤§ãã•ã ãŒã€Promptagatorã¯ã‚ãšã‹110Mã®ã¿ã§ã‚ã‚‹ã€‚"
  },
  {
    "objectID": "posts/20230429_promptagator/index.html#abalation-study",
    "href": "posts/20230429_promptagator/index.html#abalation-study",
    "title": "Promptagator è«–æ–‡è§£èª­",
    "section": "4.3 Abalation Study",
    "text": "4.3 Abalation Study\n\n\n\nAbalation study\n\n\nQueryãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã®åŠ¹æœ Figure2ã®å·¦å›³ã¯ã€Queryã‚’ä¸€å›ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ãŸåŠ¹æœã‚’ã—ã‚ã—ã¦ã„ã‚‹ã€‚å¤§å¤šæ•°ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã¨ã£ã¦ã€Queryãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãŒæœ‰åŠ¹ã ãŒã€é€†åŠ¹æœã®ã‚‚ã®ã‚‚å­˜åœ¨ã™ã‚‹ã€‚NFCorpus and SciFactã¯å°ã•ã„ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆãªã®ã§ã€ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã§éå­¦ç¿’ã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚\nã¾ãŸã€è©³ç´°ã«ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã•ã‚ŒãŸä¾‹ã‚’ã¿ã‚‹ã¨ã€å¤šãã‚±ãƒ¼ã‚¹ã¯Queryã¯ä¸€èˆ¬åŒ–éãã¦å¤šæ•°ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ãƒãƒƒãƒãƒ³ã‚°ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã€ã‚‚ã—ãã¯å˜ç´”ã«QueryãŒé–“é•ã£ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚‹ã€‚\nç”Ÿæˆã—ãŸQueryã§äººé–“ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä»£æ›¿ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‹ï¼Ÿ Figure2ã®çœŸã‚“ä¸­ã®å›³ã¯ã€8-shotã®Promptagatorã¯5ä¸‡ä»¶ã®äººé–“ãŒãƒ©ãƒ™ãƒªãƒ³ã‚°ã—ãŸãƒ‡ãƒ¼ã‚¿ã¨åŒã˜åŠ¹æœã§ã‚ã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã‚‹ã€‚\nPromptagatorã®Queryç”ŸæˆãŒåŠ¹ã„ã¦ã„ã‚‹ã‹ï¼Ÿ Figure2ã®å³å›³ã®GenQã¯BEIRè«–æ–‡ã®ä¸­ã§ææ¡ˆã•ã‚ŒãŸãƒ¢ãƒ‡ãƒ«ã€NQ-QGenã¯ã“ã®è«–æ–‡ææ¡ˆã—ãŸæ–¹æ³•ã§NQãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆå­¦ç¿’ã—ãŸãƒ¢ãƒ‡ãƒ«ã€NQ-QGenã¨GenQã®é•ã„ã¯Queryç”Ÿæˆã®éƒ¨åˆ†ã®ã¿ã€‚NQ-QGenã®ç²¾åº¦ã¯2.7%é«˜ã„ãŸã‚ã€ææ¡ˆã—ãŸQueryç”Ÿæˆã®æ–¹æ³•ãŒæœ‰åŠ¹ã ã¨è¨€ãˆã‚‹ã€‚\n\n\n\nImpact of FLAN\n\n\nFLANã®å½±éŸ¿ Promptagatorã®LLMã¯FLANã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹ã€‚FLANã®å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã®ä¸­ã«NQã¨Quaroãƒ‡ãƒ¼ã‚¿ãŒå«ã¾ã‚Œã„ã¦ã„ã‚‹ã€‚ãã®å½±éŸ¿ã‚’æ¤œè¨¼ã™ã‚‹ãŸã‚ï½¤ãã‚Œã‚‰ã‚’é™¤ã„ãŸãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§FLANã‚’å­¦ç¿’ã—ã€ãã®çµæœã‚’æ¯”è¼ƒã—ãŸ(ã•ã™ãŒGoogle Researchã€é‡‘ãªã‚‰ã‚ã‚‹ã®æ„Ÿã˜)ã€‚ãã®çµæœã€ç²¾åº¦ã¯è‹¥å¹²ä½ä¸‹ã—ãŸãŒã€ä»¥å‰ã®ç ”ç©¶ã‚ˆã‚Šã¯é«˜ã„ç²¾åº¦ã‚’é”æˆã—ã¦ã„ã‚‹ã€‚"
  },
  {
    "objectID": "posts/20230429_promptagator/index.html#qualitative-analysis",
    "href": "posts/20230429_promptagator/index.html#qualitative-analysis",
    "title": "Promptagator è«–æ–‡è§£èª­",
    "section": "4.4 Qualitative Analysis",
    "text": "4.4 Qualitative Analysis\n\n\n\nTop word distribution\n\n\nQueryã®æœ€åˆã®Wordã®åˆ†å¸ƒã‚’èª¿æŸ»ã—ãŸã€‚Few-shotãŒç”Ÿæˆã—ãŸQueryã®åˆ†å¸ƒã¯å®Ÿéš›ã®Queryã®åˆ†å¸ƒã¨åŒã˜ã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚‹ã€‚"
  },
  {
    "objectID": "posts/20230429_promptagator/index.html#neural-retrieval-models",
    "href": "posts/20230429_promptagator/index.html#neural-retrieval-models",
    "title": "Promptagator è«–æ–‡è§£èª­",
    "section": "Neural retrieval models",
    "text": "Neural retrieval models\nNeural retrieval modelã¯representation based modelã¨interaction based modelã®2ã¤ã«åˆ†é¡ã§ãã‚‹ã€‚\nRepresentation based modelã¯Queryã¨Documentä¸¡æ–¹ã¨ã‚‚åˆ†æ•£è¡¨ç¾ã«å¤‰æ›ã—ã€åˆ†æ•£è¡¨ç¾ã®é¡ä¼¼åº¦ã§ç›¸é–¢æ€§ã‚’æ¸¬ã£ã¦ã„ã‚‹ã€‚æœ€è¿‘ã®ç ”ç©¶ã¯ä»¥ä¸‹ã®ã“ã¨ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã—ã¦ã„ã‚‹ï¼š\n\nã‚ˆã‚Šè‰¯ã„å‰å­¦ç¿’ã™ã‚‹ã‚¿ã‚¹ã‚¯ã‚„ãƒ¢ãƒ‡ãƒ«ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’é–‹ç™ºã™ã‚‹\nMulti-Vectorã§ã‚ˆã‚Šåˆ†æ•£è¡¨ç¾ã®è¡¨ç¾æ€§èƒ½ã‚’å‘ä¸Šã•ã›ã‚‹\nã‚ˆã‚Šã‚ˆã„Negative sampleæ‰‹æ³•ã‚’é–‹ç™ºã™ã‚‹\nãƒ‰ãƒ¡ã‚¤ãƒ³æ¨ªæ–­ã§ã®æ±åŒ–æ€§èƒ½ã‚’å‘ä¸Šã•ã›ã‚‹\n\nInteraction based modelã ã¨ã€Queryã¨Documentã‚’ä¸€ç·’ã«å‡¦ç†ã™ã‚‹ãŸã‚ã€ç²¾åº¦ãŒé«˜ã„ã€‚ä¸€æ–¹ã€è¨ˆç®—ã‚³ã‚¹ãƒˆãŒé«˜ã„ãŸã‚ã€Rerankerã¨ã—ã¦ä½¿ã‚ã‚Œã‚‹ã“ã¨ãŒå¤šã„ã€‚ãã‚Œã«é–¢ã™ã‚‹ç ”ç©¶ã¯ä»¥ä¸‹ã®ã‚‚ã®ãŒã‚ã‚‹ï¼š\n\nInteraction based modelã‚’è’¸ç•™ã—ã€Representation based modelã¨ã—ã¦ä½¿ã†ã€‚\nInteractionã‚’æœ€å¾Œã«ã•ã›ã‚‹ã“ã¨ã€‚"
  },
  {
    "objectID": "posts/20230429_promptagator/index.html#prompt-based-query-generation",
    "href": "posts/20230429_promptagator/index.html#prompt-based-query-generation",
    "title": "Promptagator è«–æ–‡è§£èª­",
    "section": "Prompt-based query generation",
    "text": "Prompt-based query generation\nUPRï¼šç›´æ¥LLMSã‚’ä½¿ã£ã¦Rerankã‚’è¡Œã†\nInParsï¼šGPT3ã§Queryã‚’ç”Ÿæˆã—ã€T5ã®Rerankerã‚’å­¦ç¿’ã™ã‚‹"
  },
  {
    "objectID": "posts/20230429_promptagator/index.html#retrievers-with-late-interactions",
    "href": "posts/20230429_promptagator/index.html#retrievers-with-late-interactions",
    "title": "Promptagator è«–æ–‡è§£èª­",
    "section": "Retrievers with late interactions",
    "text": "Retrievers with late interactions\nDual encoder modelã®åŠ¹ç‡ãŒè‰¯ã„ãŒã€Queryã¨Documentã®ç›¸äº’ä½œç”¨ã¯æœ€å¾Œã®å†…ç©ã®ã¿ã§ã‚ã‚‹ãŸã‚ã€æ€§èƒ½ãŒå¼±ã„ã€‚ColBERTã¨SPLADEã¯æœ€å¾Œã®Token-level interactionã‚’ä½¿ã£ãŸãŸã‚ã€è¨ˆç®—ã‚³ã‚¹ãƒˆã‚’å°‘ã—çŠ ç‰²ã—ã¦æ€§èƒ½ã‚’å‘ä¸Šã•ã›ãŸã€‚"
  },
  {
    "objectID": "posts/20230428_inpars/index.html",
    "href": "posts/20230428_inpars/index.html",
    "title": "InPars è«–æ–‡è§£èª­",
    "section": "",
    "text": "InParsè«–æ–‡ã§ã¯ã€æ“¬ä¼¼ãƒ‡ãƒ¼ã‚¿ï¼ˆPseudo dataï¼‰ç”Ÿæˆã«ã‚ˆã‚‹ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ¢ãƒ‡ãƒ«å­¦ç¿’æ‰‹æ³•ã‚’ææ¡ˆã€‚LLMã‚’ç”¨ã„ã¦æ“¬ä¼¼ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã—ã€ãã‚Œã‚’ä½¿ã£ã¦ãƒ¢ãƒ‡ãƒ«ã‚’å­¦ç¿’ã•ã›ã‚‹ã“ã¨ã§ã€æƒ…å ±æ¤œç´¢ï¼ˆIRï¼‰ã®ç²¾åº¦ã‚’å‘ä¸Šã•ã›ã‚‹ã€‚å®Ÿé¨“ã§ã¯ã€ç”Ÿæˆã•ã‚ŒãŸæ“¬ä¼¼ãƒ‡ãƒ¼ã‚¿ã§MonoT5ã‚’Fine-tuningã—ã€çµæœã¨ã—ã¦å¾“æ¥ã®Unsupervisedãƒ¢ãƒ‡ãƒ«ã‚ˆã‚Šå„ªã‚ŒãŸæ€§èƒ½ã‚’ç¤ºã—ãŸã€‚\nè«–æ–‡URLï¼šhttps://arxiv.org/abs/2202.05144"
  },
  {
    "objectID": "posts/20230428_inpars/index.html#introduction",
    "href": "posts/20230428_inpars/index.html#introduction",
    "title": "InPars è«–æ–‡è§£èª­",
    "section": "1. Introduction",
    "text": "1. Introduction\nLLMã¯é«˜æ€§èƒ½ã‚’èª‡ã‚‹ã‚‚ã®ã®ã€æƒ…å ±æ¤œç´¢ï¼ˆIRï¼‰ã¸ã®å¿œç”¨ãŒåˆ¶é™ã•ã‚Œã¦ã„ã‚‹ç†ç”±ã¨ã—ã¦ã€å¤§è¦æ¨¡ãªè¨ˆç®—é‡ãŒå¿…è¦ã§ã‚ã‚‹ã“ã¨ã¨ã€ã‚³ã‚¹ãƒˆãŒé«˜ã„ã“ã¨ãŒæŒ™ã’ã‚‰ã‚Œã‚‹ã€‚GPT-3ã®åŸ‹ã‚è¾¼ã¿ã‚µãƒ¼ãƒ“ã‚¹ã‚’åˆ©ç”¨ã™ã‚‹å ´åˆã€ã™ã¹ã¦ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’å°‘ãªãã¨ã‚‚1å›ã¯å‡¦ç†ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€ä»¶æ•°ãŒå¤šã„å ´åˆã€ã‚³ã‚¹ãƒˆãŒè†¨å¤§ã«ãªã‚‹ã“ã¨ãŒå•é¡Œã¨ãªã‚‹ã€‚\nã¾ãŸã€å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã«ã‚‚èª²é¡ŒãŒå­˜åœ¨ã—ã€ç¾å­˜ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒå•†ç”¨åˆ©ç”¨ã«é©ã•ãªã„ã‚‚ã®ãŒå¤šãã€ã¾ãŸã€æ—¢å­˜ã®ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ã¦å­¦ç¿’ã—ãŸãƒ¢ãƒ‡ãƒ«ãŒä»–ã®é ˜åŸŸã«æ±ç”¨æ€§ã‚’æŒãŸãªã„ã¨ã„ã†å•é¡ŒãŒã‚ã‚‹ã€‚\nã“ã®è«–æ–‡ã§ã¯ã€æ¤œç´¢æ¨è«–ã«LLMã‚’ç›´æ¥ä½¿ç”¨ã™ã‚‹ã®ã§ã¯ãªãã€LLMã‚’ç”¨ã„ã¦æ“¬ä¼¼ãƒ‡ãƒ¼ã‚¿ï¼ˆPseudo dataï¼‰ã‚’ç”Ÿæˆã—ã€ãã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ¢ãƒ‡ãƒ«ã‚’å­¦ç¿’ã™ã‚‹æ‰‹æ³•ã‚’ææ¡ˆã—ã¦ã„ã‚‹ã€‚"
  },
  {
    "objectID": "posts/20230428_inpars/index.html#related-work",
    "href": "posts/20230428_inpars/index.html#related-work",
    "title": "InPars è«–æ–‡è§£èª­",
    "section": "2. Related work",
    "text": "2. Related work\nã“ã‚Œã¾ã§æƒ…å ±æ¤œç´¢ï¼ˆIRï¼‰é ˜åŸŸã«ãŠã‘ã‚‹ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆã®ç ”ç©¶ã§ã¯ã€BM25ã‚’ç”¨ã„ã¦é¡ä¼¼åº¦ãŒé«˜ã„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ãƒšã‚¢ã¨ã—ã¦ãƒ¢ãƒ‡ãƒ«ã‚’å­¦ç¿’ã™ã‚‹ç ”ç©¶ãŒå­˜åœ¨ã™ã‚‹ã€‚ã¾ãŸã€æ•™å¸«ã‚ã‚Šã®ãƒ¢ãƒ‡ãƒ«ã§ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰Queryã‚’ç”Ÿæˆã—ã€ãã‚Œã¨ãƒ†ã‚­ã‚¹ãƒˆã®ãƒšã‚¢ã‚’å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã¨ã™ã‚‹ç ”ç©¶ã‚‚ã‚ã£ãŸã€‚\nã“ã®ç ”ç©¶ã®ç‰¹å¾´ã¨ã—ã¦ã€ãƒ¢ãƒ‡ãƒ«ã‚’å­¦ç¿’ã•ã›ãªãã€LLMã‹ã‚‰Few-shotã§ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã—ãŸã“ã¨ï¼ˆã¡ã‚‡ã£ã¨æ–°å¥‡æ€§ãŒè¶³ã‚Šã¦ã„ãªã„æ°—ãŒã™ã‚‹ï¼‰ã€‚"
  },
  {
    "objectID": "posts/20230428_inpars/index.html#our-method-inpars",
    "href": "posts/20230428_inpars/index.html#our-method-inpars",
    "title": "InPars è«–æ–‡è§£èª­",
    "section": "3. Our Method: InPars",
    "text": "3. Our Method: InPars\nä»¥ä¸‹ã¯InParsã®ã‚¹ãƒ†ãƒƒãƒ—ï¼š\n\nè¤‡æ•°ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨ã‚¯ã‚¨ãƒªãƒ¼ã®ãƒšã‚¢ãŒå­˜åœ¨ã™ã‚‹ã¨ä»®å®šã™ã‚‹ã€‚ãã‚Œã‚’ä¾‹ã¨ã—ã¦ã€Few-shotã§LLMã§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«é–¢é€£ã™ã‚‹ã‚¯ã‚¨ãƒªãƒ¼ã‚’ç”Ÿæˆã—ã¦ã‚‚ã‚‰ã†ã€‚(\nè©³ç´°ã¯4.2ã§ç´¹ä»‹ã™ã‚‹ï¼‰\nç”Ÿæˆã—ãŸãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨ã‚¯ã‚¨ãƒªãƒ¼ã®ãƒšã‚¢ã«ã¤ã„ã¦ã€LLMãŒå‡ºåŠ›ã™ã‚‹éš›ã«å‡ºã—ã¦ã„ã‚‹çµæœã®Log probabilityãŒä¸Šä½ã®ã‚‚ã®ã‚’é¸æŠã™ã‚‹ã€‚ã¡ãªã¿ã«ã€ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ãŒå¤§ããç²¾åº¦ã‚’æ”¹å–„ã—ãŸã€‚\nç”Ÿæˆã—ãŸqã¨dã®ãƒšã‚¢ã‚’å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦Rerankã®ãƒ¢ãƒ‡ãƒ«ã‚’Fine-tuningã™ã‚‹ã€‚ï¼ˆè©³ç´°ã¯4.3ã§ç´¹ä»‹ã™ã‚‹ï¼‰\n\n\n\n\nInPars"
  },
  {
    "objectID": "posts/20230428_inpars/index.html#experimental-setup",
    "href": "posts/20230428_inpars/index.html#experimental-setup",
    "title": "InPars è«–æ–‡è§£èª­",
    "section": "4. Experimental Setup",
    "text": "4. Experimental Setup\n\n4.1 Datasets\nä»Šå›ä½¿ç”¨ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¯ä»¥ä¸‹ï¼š\n\nMS MARCOï¼šMicrosoftãŒå‡ºã—ãŸBingã®å®Ÿéš›ã®ãƒ¦ãƒ¼ã‚¶ãƒ­ã‚°ã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ãŸå¤§å‹ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã€‚880ä¸‡ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨50ä¸‡ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨ã‚¯ã‚¨ãƒªãƒ¼ã®ãƒšã‚¢ãŒã‚ã‚‹ã€‚å„ã‚¯ã‚¨ãƒªãƒ¼ãŒå¹³å‡çš„ã«1ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«å¯¾å¿œã™ã‚‹ã€‚\nTREC-DLï¼šMS MARCOã¨åŒã˜ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æŒã£ã¦ã„ã‚‹ãŒã€ã‚¯ã‚¨ãƒªãƒ¼ã¯54ä»¶ã®ã¿ã§ã‚ã‚‹ã€‚ã¾ãŸã€å„ã‚¯ã‚¨ãƒªãƒ¼ã«ã¤ã„ã¦ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã—ãŸãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒå¤šã„ã€‚\nRobust04ï¼šæ–°èé ˜åŸŸã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã€‚52ä¸‡ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒã‚ã‚Šã€249ã‚¯ã‚¨ãƒªãƒ¼ãŒã‚ã‚‹ã€‚å„ã‚¯ã‚¨ãƒªãƒ¼ã«å¯¾ã—ã¦ã€å¹³å‡çš„ã«1250ä»¶ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã—ãŸã€‚\nNatural Questionsï¼š260ä¸‡ä»¶ã®Wikipediaãƒ†ã‚­ã‚¹ãƒˆã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ãŸQuestion Answer ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã€‚Questionã¯Googleã®æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã®ãƒ­ã‚°ã‹ã‚‰ä½œã£ãŸã‚‚ã®ã€‚\nTREC-COVIDï¼šã‚³ãƒ­ãƒŠã®æƒ…å ±ã«é–¢ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ\n\n\n\n4.2 Training Data Generation\nå„å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã¯ï¼ˆQuery, Positive document, Negative documentï¼‰ã®Tripleã«ã‚ˆã£ã¦æ§‹æˆã•ã›ã‚‹ã€‚ãã®ç”Ÿæˆã®ã‚¹ãƒ†ãƒƒãƒ—ã¯ä»¥ä¸‹ï¼š\n\n10ä¸‡ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã—ã€GPT3ã®Curieã§Queryã‚’ç”Ÿæˆã•ã›ã‚‹ã€‚\næœ€çµ‚çš„ã«Log probabilityãŒä¸Šä½ã®1ä¸‡ä»¶ã®ãƒšã‚¢ã®ã¿å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ä½¿ã†ã€‚\nBM25ã§æ¤œç´¢ã—ãŸ1000ä»¶ã®ä¸­ã§ãƒ©ãƒ³ãƒ€ãƒ ã«1ä»¶ã‚’æŠ½å‡ºã—ã€ãã‚Œã‚’Negative Documentã¨ã™ã‚‹ã€‚ï¼ˆã“ã®ã‚„ã‚Šæ–¹ã§å¤šãã®ãƒã‚¤ã‚ºã‚’å…¥ã‚Œã¦ã—ã¾ã†ã®ã§ã¯ï¼Ÿï¼‰\n\nä»¥ä¸‹ã¯ï¼’ç‚¹ã®è£œè¶³ï¼š\n\nç”Ÿæˆã™ã‚‹éš›ã«æ¸©åº¦ã¨Topãƒ¼Pã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®šã¯çµæœã«æœ‰æ„ã®å½±éŸ¿ã—ãªã„ã€‚\né•·ã•ãŒ300æ–‡å­—ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯æ¨ã¦ã‚‰ã‚Œã‚‹ã€‚\n\nQueryç”Ÿæˆã™ã‚‹éš›ã«Promptã®æ›¸ãæ–¹ã¯2ã¤ã‚’åˆ©ç”¨ã—ãŸï¼ˆFigureï¼’)ï¼š\n\nä¸€èˆ¬æ–¹æ³•ï¼ˆVanilla)ï¼šMS MARCOã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«3ã¤ã®ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã—ã€ãã‚Œã‚’ä¾‹ã¨ã—ã¦ã€Fewãƒ¼shotã§Queryã‚’ç”Ÿæˆã•ã›ã‚‹ã€‚\nGBQï¼ˆGuided by Bad Questionsï¼‰ï¼šä¸€èˆ¬æ–¹æ³•ã¨åŒã˜ã‚ˆã†ã«ã€MS MARCOã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«3ã¤ã®ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã™ã‚‹ã€‚ã—ã‹ã—ã€MS MARCOã®QueryãŒæ¼ ç„¶ã™ãã‚‹ãŸã‚ã€ãã‚Œã‚’Bad questionã¨ã—ã¦æç¤ºã™ã‚‹ã€‚Documentã‚’èª­ã‚“ã§ã€ã‚ˆã‚Šé–¢é€£ã™ã‚‹Good Questionã‚’æ‰‹å‹•ã§ä½œã£ãŸã€‚ï¼ˆDocument, Good Question, Bad Question)ã§ä¾‹ã‚’æç¤ºã—ã€ç”Ÿæˆã—ãŸGood Questionã‚’Queryã¨ã™ã‚‹ã€‚\n\n\n\n\nPrompt example\n\n\n\n\n4.3 Retrieval Methods\nï¼’æ®µéšã®æ¤œç´¢ã‚’æ¡ç”¨ã—ã¦ã„ã‚‹ã€‚ã¾ãšBM25ã§ä¸Šä½1000ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å–ã‚Šå‡ºã™ã€‚ãã®æ¬¡ã€MonoT5ã‚’ä½¿ã£ã¦Rerankingã‚’ã™ã‚‹ã€‚\nMonoT5ã¯Transformerã®Encoderã¨Decoderä¸¡æ–¹ã¨ã‚‚ä½¿ã£ã¦ã„ã‚‹ãƒ¢ãƒ‡ãƒ«ã§ã€Cross-Encoderãƒ¢ãƒ‡ãƒ«ã§ã‚ã‚‹ã€‚ä»Šå›ã®å®Ÿé¨“ã§ã¯ã€ã‚µã‚¤ã‚ºã¯220Mã¨3Bã®ãƒ¢ãƒ‡ãƒ«ã§ãƒ†ã‚¹ãƒˆã—ãŸã€‚\nå„ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ãŠã„ã¦ä½œæˆã•ã‚ŒãŸæ“¬ä¼¼ãƒ‡ãƒ¼ã‚¿ã§MonoT5ã‚’Fine-tuningã—ãŸã€‚"
  },
  {
    "objectID": "posts/20230428_inpars/index.html#results",
    "href": "posts/20230428_inpars/index.html#results",
    "title": "InPars è«–æ–‡è§£èª­",
    "section": "5 Results",
    "text": "5 Results\n\n7,8è¡Œç›®ã‚’è¦‹ã‚‹ã¨ã€BM25ã‚„Contrieverç­‰ã®ä»¥å‰ã®Unsupervisedçµæœã‚ˆã‚Šå„ªã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚‹ã€‚ã¾ãŸã€16è¡Œç›®ã¯MS MARCOã§Fine-tuningã—ãŸå¾Œã•ã‚‰ã«æ“¬ä¼¼ãƒ‡ãƒ¼ã‚¿ã§Fine-tuningã—ãŸçµæœã€‚å¹¾ã¤ã‹ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§å˜ç´”ã«MS MARCOã§Fine-tuningã™ã‚‹ã‚ˆã‚Šè‰¯ã„çµæœãŒå‡ºã¦ã„ã‚‹ã€‚"
  },
  {
    "objectID": "posts/20230428_inpars/index.html#ablation-study-and-analysis",
    "href": "posts/20230428_inpars/index.html#ablation-study-and-analysis",
    "title": "InPars è«–æ–‡è§£èª­",
    "section": "6 Ablation Study and Analysis",
    "text": "6 Ablation Study and Analysis\n6.1 Prompt Selection and Source Corpus\næ¯”è¼ƒå¯¾è±¡ãŒæ··ä¹±ã®ãŸã‚ã€ä½•ãŒè¨€ã„ãŸã„ã‹ãŒã‚ã‹ã‚‰ãªã‹ã£ãŸã€‚\n6.2 Model Size Impact on IR Metrics\nå½“ãŸã‚Šå‰ã ã‘ã©ã€Questionã‚’ç”Ÿæˆã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã®ã‚µã‚¤ã‚ºãŒå¤§ãã„ã»ã©çµæœãŒã‚ˆããªã‚‹ã€‚\n6.3 Filtering by the Most Likely Questions\nTop1ä¸‡ä»¶ã®ãƒ‡ãƒ¼ã‚¿ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šç²¾åº¦ãŒå‘ä¸Šã—ãŸã€‚\n6.4 Was GPT-3 Trained on Supervised IR Data?\nç”Ÿæˆã—ãŸQuestionãŒã©ã®ãã‚‰ã„å®Ÿéš›ã®MS MARCOãƒ‡ãƒ¼ã‚¿ã«ã‚ã‚‹ã‹ã§ã€GPT3ã®å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã«MS MARCOã®ãƒ‡ãƒ¼ã‚¿ã‚’å«ã¾ã‚Œã¦ã„ã‚‹ã‹ã‚’æ¤œè¨¼ã—ãŸã€‚çµæœã¨ã—ã¦ã¯å¤šãã¦ã‚‚10ï¼…å‰å¾Œã®ãŸã‚å½±éŸ¿ãŒãªã„ã€‚ï¼ˆæ¤œè¨¼ã®ã‚„ã‚Šæ–¹ãŒæ­£ã—ã„ã‹ãŒç–‘å•ï¼‰"
  },
  {
    "objectID": "posts/20230428_inpars/index.html#conclusion-and-future-work",
    "href": "posts/20230428_inpars/index.html#conclusion-and-future-work",
    "title": "InPars è«–æ–‡è§£èª­",
    "section": "7 Conclusion and Future Work",
    "text": "7 Conclusion and Future Work\næœ¬æ–‡ã¯ã€LLMã‚’åˆ©ç”¨ã—ã¦Queryã‚’ç”Ÿæˆã—ã¦ã€ç”Ÿæˆã—ãŸQueryã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ãƒšã‚¢ã‚’å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã§ãƒ¢ãƒ‡ãƒ«ã‚’å­¦ç¿’ã™ã‚‹æ‰‹æ³•ã‚’ææ¡ˆã—ãŸã€‚\nä»Šå¾Œã®æ”¹å–„ç‚¹ã¨ã—ã¦ã¯ã€\n\næ“¬ä¼¼ãƒ‡ãƒ¼ã‚¿ã§Dense Retrieverã‚’Fine-tuningã™ã‚‹ï¼ˆä»Šå›ã¯Rerankerã®ã¿ï¼‰\nãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã™ã‚‹éš›ã«ä½œã£ãŸâ€BAD questionâ€ã‚’Negative exampleã¨ã—ã¦ä½¿ç”¨ã™ã‚‹\næ“¬ä¼¼ãƒ‡ãƒ¼ã‚¿ã®æ•°ã‚’å¢—ã‚„ã™\nï¼ˆQuery, Document)ã®ãƒšã‚¢ã‚’æ¢ã™ã‚‚ã£ã¨è‰¯ã„æ‰‹æ³•ã‚’é–‹ç™ºã™ã‚‹"
  },
  {
    "objectID": "posts/20230502_inpars_light/index.html",
    "href": "posts/20230502_inpars_light/index.html",
    "title": "InPars light è«–æ–‡è§£èª­",
    "section": "",
    "text": "InPars-lightã¯ã€ç„¡æ–™ã§åˆ©ç”¨å¯èƒ½ãªè¨€èªãƒ¢ãƒ‡ãƒ«BLOOMã‚’ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã—ã€1000å€‹ã§ã¯ãªã100å€‹ã®å€™è£œãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å†ãƒ©ãƒ³ã‚¯ã—ã—ãŸã€‚ å…ˆè¡Œç ”ç©¶ã®ä¸»è¦ãªçŸ¥è¦‹ã‚’å†ç¾ã™ã‚‹ã ã‘ã§ãªãã€Consistency checkingã¨All-domain pre-trainingã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€éå¸¸ã«åŠ¹ç‡çš„ã§å°å‹ãªãƒ¢ãƒ‡ãƒ«MiniLM-L6-30Mã‚’è¨“ç·´ã—ã€ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§BM25ã‚’ä¸Šå›ã‚‹æ€§èƒ½ã‚’é”æˆã—ãŸã€‚æœ€å¾Œã«ã€å¤§ããªDeBERTA-v3-435Mãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã€7å€å¤§ããªMonoT5-3Bã®æ€§èƒ½ã‚’ã»ã¼ãƒãƒƒãƒã•ã›ã‚‹ã“ã¨ãŒã§ããŸã€‚\nè«–æ–‡URLï¼š&lt;https://arxiv.org/abs/2301.02998&gt;"
  },
  {
    "objectID": "posts/20230502_inpars_light/index.html#related-work",
    "href": "posts/20230502_inpars_light/index.html#related-work",
    "title": "InPars light è«–æ–‡è§£èª­",
    "section": "2 Related Work",
    "text": "2 Related Work\nUPR: 3Bã®LLMã‚’Rerankã¨ã—ã¦ä½¿ã£ãŸã€‚ç¬¬ä¸€æ®µéšã§å–ã‚Šå‡ºã—ãŸãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«å¯¾ã—ã¦â€please write a question for this documentâ€ã§Queyrã‚’ç”Ÿæˆã™ã‚‹Log probabiltyã‚’è¨ˆç®—ã—ã€ãã‚Œã§Rerankã‚’ã—ã¦ã„ã‚‹ã€‚(LLMã‚’å­¦ç¿’ã•ã›ã‚‹éš›ã«Lossã®è¨ˆç®—ã¨åŒã˜ã‚„ã‚Šæ–¹)\nãã®ä»–ã€InPars-v1ã€InPars-v2ã€Promptagatorã€HyDEãŒç´¹ä»‹ã•ã‚ŒãŸã€‚ä»¥å‰ã®è«–æ–‡ç´¹ä»‹ã§è©³ç´°ã‚’æ›¸ã„ãŸãŸã‚ã€ä»Šå›ã¯å‰²æ„›ã™ã‚‹ã€‚"
  },
  {
    "objectID": "posts/20230502_inpars_light/index.html#methods",
    "href": "posts/20230502_inpars_light/index.html#methods",
    "title": "InPars light è«–æ–‡è§£èª­",
    "section": "3 Methods",
    "text": "3 Methods\nã“ã®è«–æ–‡ã‚‚2æ®µéšã®æ¤œç´¢ã‚’ä½¿ã£ãŸã€‚ã¾ãšBM25ã§å¤§é‡ãªDocumentã‹ã‚‰é–¢é€£ã™ã‚‹Documentã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹ã€‚ãã®ã¤ãã«ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒ¢ãƒ‡ãƒ«ã§Rerankã™ã‚‹ã€‚\nRerankã¯Cross-encoderã‚’åˆ©ç”¨ã—ãŸã€‚å…·ä½“çš„ã«ä»¥ä¸‹ã®3ç¨®é¡ãªã‚‚ã®ãŒã‚ã‚‹ã€‚\n\nMiniLM-L6(30M)\nERNIE-v2(335M)\nDeBERTA-v3(435M)\n\nERNIEã¨DeBERTAã‚’åˆ©ç”¨ã—ãŸç†ç”±ã¨ã—ã¦ã¯ã€ä»Š2ã¤ã®ãƒ¢ãƒ‡ãƒ«ã¯MS MARCOã§å¼·ã„çµæœã‚’å‡ºã—ãŸã“ã¨ãŒã‚ã‚‹ã€‚\nInparsã¨åŒã˜ã‚ˆã†ã«å„ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«å¯¾ã—ã¦100kã®Queryã‚’ç”Ÿæˆã—ãŸã€‚ç”Ÿæˆã—ãŸQueryã¨Documentã®ãƒšã‚¢ã§Rerankerã‚’å­¦ç¿’ã•ã›ã€ãã‚Œã‚’ä½¿ã£ã¦Consistency checkingã‚’ã—ãŸã€‚Consistency checkingã‚’ã™ã‚‹æ™‚ã«ã€ç”Ÿæˆã—ãŸQueryã§æ¤œç´¢ã‚’ã‹ã‘ã¦ã€ç”Ÿæˆå…ƒã®DocumentãŒTop-Kã«ãªã„ã¨ãã‚Œã‚’æ¨ã¦ã‚‹ã€‚Kã«ã¤ã„ã¦ã¯ã€1ã§ã‚‚è‰¯ã„ãŒã€3ã®ã»ã†ãŒç²¾åº¦ãŒé«˜ã‹ã£ãŸã€‚\nã¾ãŸã€é¢ç™½ã„ã®ã¯ã€Consistency checkingã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ãŸãƒ‡ãƒ¼ã‚¿ã¨Log Probabilityã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ãŸãƒ‡ãƒ¼ã‚¿ã¯20ã€œ30%ã®ã¿å…±é€šã—ã¦ã„ã‚‹ã€‚\nRerankerã‚’å­¦ç¿’ã•ã›ã‚‹éš›ã«ã€ã¾ãšç”Ÿæˆã—ãŸå…¨ãƒ‡ãƒ¼ã‚¿ã§å­¦ç¿’ã•ã›ã€ãã®ä¸Šã§ã€ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ãŸãƒ‡ãƒ¼ã‚¿ã§Fine-Tuningã‚’è¡Œã£ãŸã€‚\nã“ã®ç ”ç©¶ã§MiniMLã«å¯¾ã—ã¦ã€ã¾ãšã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ç”Ÿæˆã—ãŸã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã§å­¦ç¿’ã—ã€ã•ã‚‰ã«ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ãŸãƒ‡ãƒ¼ã‚¿ã§Fine-Tuningã—ãŸãŒã€éå­¦ç¿’ã—ãŸã€‚\nå®Ÿè£…ã™ã‚‹éš›ã«ã€FlexNeuARTã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’ä½¿ã£ãŸã€‚ãƒ¢ãƒ‡ãƒ«ã‚’å­¦ç¿’ã•ã›ã‚‹éš›ã«InfoNCE Lossã‚’ä½¿ã£ãŸã€‚å„Queryã«å¯¾ã—ã¦Negative sampleã‚’ã€BM25ã§æ¤œç´¢ã§ããŸä¸Šä½1000ä»¶ã®ä¸­ã‹ã‚‰3ã¤ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã—ãŸã€‚\nå„ãƒ¢ãƒ‡ãƒ«ã«ã¤ã„ã¦ã€3ã¤ã®Seedã§3å›å­¦ç¿’ã—ã€çµæœã®å¹³å‡å€¤ã‚’ã¨ã£ãŸã€‚çµæœã®æœ‰æ„æ€§ã®ãƒã‚§ãƒƒã‚¯ã¯paired two-sided t-testã‚’ä½¿ã£ãŸã€‚å¤§ãã„ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã ã¨0.01ã®é–¾å€¤ã‚’ä½¿ã£ãŸã€‚å°ã•ã„ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã ã¨ã€0.05ã®é–¾å€¤ã‚’ä½¿ã£ãŸã€‚\nPromptã®ä½œã‚Šæ–¹ã¯InParsãŒä½¿ã£ãŸä¸€èˆ¬çš„ãªã‚„ã‚Šæ–¹ã¨åŒã˜ã€‚Queryã‚’ç”Ÿæˆã™ã‚‹éš›ã«ã€æœ€å¤§Tokenæ•°ã‚’32ã«è¨­å®šã—ãŸã€‚"
  },
  {
    "objectID": "posts/20230502_inpars_light/index.html#ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ",
    "href": "posts/20230502_inpars_light/index.html#ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ",
    "title": "InPars light è«–æ–‡è§£èª­",
    "section": "4 ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ",
    "text": "4 ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ\nInPars[4]ã®ä¸»è¦çµæœã‚’å†ç¾ã™ã‚‹ãŸã‚ã«ã€åŒã˜ã‚¯ã‚¨ãƒªã¨ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ä½¿ç”¨ã—ãŸã€‚MS MARCOä»¥å¤–ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¯ã€Œir_datasetsã€ã¨ã„ã†ãƒ„ãƒ¼ãƒ«ã‚’åˆ©ç”¨ã—ã¦å‡¦ç†ã—ãŸã€‚\nInParsã®è«–æ–‡ã§æä¾›ã—ãŸGithubã«GPT-3 Curieãƒ¢ãƒ‡ãƒ«ã§ç”Ÿæˆã•ã‚ŒãŸã‚¯ã‚¨ãƒªã¨ã€ãã‚Œã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã®æ–‡æ›¸ãŒæä¾›ã•ã‚Œã¦ã„ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€GPT-3 Curieã¨ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«GPT-Jã€BLOOMã§ç”Ÿæˆã•ã‚ŒãŸQueryã®å“è³ªã‚’æ¯”è¼ƒã§ãã‚‹ã€‚ã‚¯ã‚¨ãƒªã®ç”Ÿæˆã‚³ã‚¹ãƒˆãŒã¾ã é«˜ã„ãŸã‚ã€ä»–ã®ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«ã®æ¤œè¨ã¯å°†æ¥ã®èª²é¡Œã§ã‚ã‚‹ã€‚"
  },
  {
    "objectID": "posts/20230502_inpars_light/index.html#results",
    "href": "posts/20230502_inpars_light/index.html#results",
    "title": "InPars light è«–æ–‡è§£èª­",
    "section": "5 Results",
    "text": "5 Results\n\n5.1 Main Results\n\n\n\nmain results\n\n\nBM25 ã“ã®è«–æ–‡ã¯ä½¿ã†ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ã¤ã„ã¦å°‘ã—èª¿æ•´ã—ãŸãŒã€InParsã®çµæœã¨å¤§ããå¤‰ã‚ã‚‰ãªã„ã€‚\næ•™å¸«ãªã—å­¦ç¿’ ä»Šå›ä½¿ã£ãŸDeBERTA-v3-435Mã¯ä»¥å‰ã®MonoT5-3Bã®æ€§èƒ½ã¨åŒã˜ã€‚ã¾ãŸä»Šå›ææ¡ˆã—ãŸMiniLM-L6-30Mã¯InParsã®ã‚‚ã®T5-220Mç›¸å½“ãªæ€§èƒ½ã‚’å‡ºã—ã¦ã„ã‚‹ã€‚\nConsistency checkingã¨all-domain pre-training ä¸¡æ–¹ã¨ã‚‚è‰¯ã„å½±éŸ¿ã‚’ä¸ãˆã‚‹ã“ã¨ãŒã‚ã‹ã‚‹ã€‚Deberta-v3-435Mã«å¯¾ã—ã¦All-domain pre-trainingãŒé€†åŠ¹æœãŒã‚ã‚‹ãŒã€ç†ç”±ãŒä¸æ˜ã€‚\næ•™å¸«ã‚ã‚Šå­¦ç¿’ ä»Šå›ææ¡ˆã—ãŸ2ã¤ã®ãƒ¢ãƒ‡ãƒ«ã®æ€§èƒ½ãŒã„ã¾ã„ã¡ã€‚\n\n\n\nmodel performance\n\n\nQueryã‚’ç”Ÿæˆã™ã‚‹LLMãƒ¢ãƒ‡ãƒ«ã®æ¯”è¼ƒã«ã¤ã„ã¦ã€ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã®GPT-Jã¨BLOOMã¯Open AI Curieã‚ˆã‚Šã‚ˆã„æ€§èƒ½ã‚’å‡ºã—ã¦ã„ã‚‹ã€‚\nã¾ãŸã€Rerankerã«ã¤ã„ã¦ã¯ã€Deberta-v3-435Mã¯ERNIE-v2-335Mã‚ˆã‚Šã‚ˆã„ã“ã¨ãŒã‚ã‹ã‚‹ã€‚\n\n\n5.2 Cost and Efficiency\nRTX3039ã‚’ä½¿ã†å ´åˆã¯ï¼š\n\nMiniLM-L6-30Mã®æ¨è«–ã®Throughputã¯1ç§’500ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ(LLMå„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®é•·ã•ã¯477ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ä»¥ä¸‹)ã€ãã®ãŸã‚ã€100ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’Rerankã™ã‚‹å ´åˆã¯1ç§’ã‹ã‹ã‚‰ãªã„ã€‚\nMiniLM-L6-30Mã‚’å…¨ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§å‰å­¦ç¿’ã—ã¦ã‚‚2æ™‚é–“ã—ã‹ã‹ã‹ã‚‰ãªã„ã€‚ä¸€æ–¹ã€Deberta-v3-435Mã¯28æ™‚é–“ã‹ã‹ã‚‹ã€‚\nall-domain pre-trainingã‚’ã™ã‚‹éš›ã«ã€ä¸€ç•ªæ™‚é–“ãŒã‹ã‹ã‚‹æ“ä½œã¯MS MARCOã®ã‚ˆã†ãªå¤§ãã„ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¨Consistency checkingã€‚Deberta-v3-435Mã§MS MARCOã§ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æ™‚é–“ã¯6æ™‚é–“ã€Consistency checkingã ã¨48æ™‚é–“ã‹ã‹ã£ãŸã€‚\nQueryç”Ÿæˆã®æ™‚é–“ï¼š100kã®Queryã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã«ã¯15æ™‚é–“ãŒã‹ã‹ã‚‹ã€‚"
  },
  {
    "objectID": "posts/20230505_tiktoken/index.html",
    "href": "posts/20230505_tiktoken/index.html",
    "title": "OpenAIã®GPTã®APIã®Tokenæ•°ã«é–¢ã™ã‚‹èª¿æŸ»",
    "section": "",
    "text": "OpenAIã®GPTãƒ¢ãƒ‡ãƒ«ã§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‡¦ç†ã™ã‚‹éš›ã«ã€æ—¥æœ¬èªã®1æ–‡å­—ã¯å¤§ã‚ˆã1Tokenã«ç­‰ã—ã„ã§ã™ã€‚åƒæ–‡å­—ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‡¦ç†ã™ã‚‹ãŸã‚ã«ã¯ã€æ¦‚ç®—ã§ã€ã‚¹ãƒ”ãƒ¼ãƒ‰é‡è¦–ã®gpt-3.5-turboã‚’ä½¿ã†å ´åˆã¯0.59å††ã‹ã‹ã‚Šã¾ã™ã€‚æ€§èƒ½é‡è¦–ã®gpt-4-32kã‚’åˆ©ç”¨ã™ã‚‹å ´åˆã¯ã€9.7å††ã‹ã‹ã‚Šã¾ã™ã€‚"
  },
  {
    "objectID": "posts/20230505_tiktoken/index.html#çµè«–",
    "href": "posts/20230505_tiktoken/index.html#çµè«–",
    "title": "OpenAIã®GPTã®APIã®Tokenæ•°ã«é–¢ã™ã‚‹èª¿æŸ»",
    "section": "",
    "text": "OpenAIã®GPTãƒ¢ãƒ‡ãƒ«ã§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‡¦ç†ã™ã‚‹éš›ã«ã€æ—¥æœ¬èªã®1æ–‡å­—ã¯å¤§ã‚ˆã1Tokenã«ç­‰ã—ã„ã§ã™ã€‚åƒæ–‡å­—ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‡¦ç†ã™ã‚‹ãŸã‚ã«ã¯ã€æ¦‚ç®—ã§ã€ã‚¹ãƒ”ãƒ¼ãƒ‰é‡è¦–ã®gpt-3.5-turboã‚’ä½¿ã†å ´åˆã¯0.59å††ã‹ã‹ã‚Šã¾ã™ã€‚æ€§èƒ½é‡è¦–ã®gpt-4-32kã‚’åˆ©ç”¨ã™ã‚‹å ´åˆã¯ã€9.7å††ã‹ã‹ã‚Šã¾ã™ã€‚"
  },
  {
    "objectID": "posts/20230505_tiktoken/index.html#ç›®çš„",
    "href": "posts/20230505_tiktoken/index.html#ç›®çš„",
    "title": "OpenAIã®GPTã®APIã®Tokenæ•°ã«é–¢ã™ã‚‹èª¿æŸ»",
    "section": "ç›®çš„",
    "text": "ç›®çš„\nGPT3ã‚’ç”¨ã„ãŸææ¡ˆã‚’ã™ã‚‹éš›ã«ã‚ˆãèã‹ã‚Œã‚‹ã“ã¨ã¨ã—ã¦ã¯ã€ã‚³ã‚¹ãƒˆã„ãã‚‰ã‹ã®ã“ã¨ã§ã™ã€‚GPT3ã®APIã®èª²é‡‘ã¯ä¸‹è¨˜ã®ã‚ˆã†ã«æ–‡å­—æ•°ã§ã¯ãªãã€tokenã‚’å˜ä½ã¨ã—ã¦ã„ã‚‹ãŸã‚ã€èª¬æ˜ã™ã‚‹ã®ã¯ç°¡å˜ã§ã¯ãªã„ã§ã™ã€‚\næœ¬æ–‡ã¯å€¤æ®µã®èª¬æ˜ã‚’ã—ã‚„ã™ã„ã‚ˆã†ã«ã€å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿ã§å®Ÿé¨“ã—ã¦ã¿ã¾ã™ã€‚ã¤ã„ã¦ã«TicTokenã®æŒ™å‹•ã«ã¤ã„ã¦ã‚‚æ˜ã‚Šä¸‹ã’ã¦ã¿ã¾ã™ã€‚ å®Ÿé¨“ã®ã‚¹ãƒ†ãƒƒãƒ—ã¯ä¸‹è¨˜ã®é€šã‚Šã§ã™ã€‚\n\nlivedoor ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‘ã‚¹ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹\n\nãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‘ã‚¹ã‚’tiktokenã§ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚ºã™ã‚‹\nTokenæ•°/æ–‡å­—æ•°ã§ã€åƒæ–‡å­—ã‚ãŸã‚Šã®å€¤æ®µã‚’è¨ˆç®—ã™ã‚‹\n\nãƒ†ã‚­ã‚¹ãƒˆè£œå®Œãƒ¢ãƒ‡ãƒ«\n\n\n\n\nãƒ¢ãƒ‡ãƒ«å\n\n\nå€¤æ®µ(Prompt)\n\n\nå€¤æ®µ(è£œå®Œ)\n\n\næœ€å¤§ãƒˆãƒ¼ã‚¯ãƒ³æ•°\n\n\nãƒ¢ãƒ‡ãƒ«ã‚µã‚¤ã‚º(æ¨æ¸¬)\n\n\n\n\ngpt-3.5-turbo\n\n\n$0.002\n\n\n$0.002\n\n\n4,096\n\n\n6.7B\n\n\n\n\ngpt-4\n\n\n$0.03\n\n\n$0.06\n\n\n8,192\n\n\nä¸æ˜\n\n\n\n\ngpt-4-32k\n\n\n$0.06\n\n\n$0.12\n\n\n32,768\n\n\nä¸æ˜"
  },
  {
    "objectID": "posts/20230505_tiktoken/index.html#å‰æº–å‚™",
    "href": "posts/20230505_tiktoken/index.html#å‰æº–å‚™",
    "title": "OpenAIã®GPTã®APIã®Tokenæ•°ã«é–¢ã™ã‚‹èª¿æŸ»",
    "section": "å‰æº–å‚™",
    "text": "å‰æº–å‚™\nGPT3ã®Tokenizerã¯tiktokenã¨ã„ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹ã®ã§ã€æ¤œè¨¼ã™ã‚‹ãŸã‚ã«ã¯tiktokenã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\nä»Šå›åˆ©ç”¨ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã¯ã€livedoor ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‘ã‚¹ã§ã™ã€‚livedoor ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‘ã‚¹ã¯ã€9ã¤ã®ã‚«ãƒ†ã‚´ãƒªã«åˆ†é¡ã•ã‚ŒãŸã€è¨˜äº‹ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã™ã€‚\n\n!pip install tiktoken\n!curl -O https://www.rondhuit.com/download/ldcc-20140209.tar.gz\n!tar -zxvf ldcc-20140209.tar.gz\n\næ¬¡ã«æ–‡å­—æ•°ã¨ãƒˆãƒ¼ã‚¯ãƒ³æ•°ã®é–¢ä¿‚ã‚’è¨ˆç®—ã—ã¾ã™ã€‚\n\nimport glob\nimport pandas as pd\nfrom matplotlib import pyplot as plt\nimport tiktoken\n\n# load data\npath_list = glob.glob('./text/*/*.txt')\ntxt_list =[]\nfor path in path_list:\n    category = path.split('/')[2]\n    with open(path) as f:\n        # skip first 2 lines\n        for i in range(2):\n            f.readline()\n        txt_list.append(( category, f.read()))\ndf =  pd.DataFrame( txt_list, columns=['category', 'text'])\ndf[\"word_count\"] = df[\"text\"].apply(lambda x: len(x))\n\n# cl100k_base is for gpt-4, gpt-3.5-turbo, text-embedding-ada-002\n# https://github.com/openai/openai-cookbook/blob/main/examples/How_to_count_tokens_with_tiktoken.ipynb\nencoder = tiktoken.get_encoding(\"cl100k_base\")\ndf[\"token_ids\"] = df[\"text\"].apply(lambda x: encoder.encode(x))\ndf[\"token_count\"] = df[\"token_ids\"].apply(lambda x: len(x))\ndf[\"tokens\"]  = df[\"token_ids\"].apply(lambda x: encoder.decode_tokens_bytes(x))\ndf[\"word_token_ratio\"] = df[\"token_count\"] / df[\"word_count\"]"
  },
  {
    "objectID": "posts/20230505_tiktoken/index.html#è¨ˆç®—",
    "href": "posts/20230505_tiktoken/index.html#è¨ˆç®—",
    "title": "OpenAIã®GPTã®APIã®Tokenæ•°ã«é–¢ã™ã‚‹èª¿æŸ»",
    "section": "è¨ˆç®—",
    "text": "è¨ˆç®—\nã¾ãšã€å‡¦ç†ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã®æ§˜å­ã‚’å®Ÿéš›ã«è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚\n\nprint(\"ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ã‚µãƒ³ãƒ—ãƒ«ï¼š\")\nfor i in txt_list[0][1].split('\\n')[:10]:\n    print(i)\nprint(\"...\")\n\nãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ã‚µãƒ³ãƒ—ãƒ«ï¼š\nã€DVDã‚¨ãƒ³ã‚¿ãƒ¼ï¼ã€‘èª˜æ‹çŠ¯ã«è‚²ã¦ã‚‰ã‚ŒãŸå¥³ãŒç›®ã«ã—ãŸçœŸå®Ÿã¯ã€å­¤ç‹¬ã‹å¹¸ç¦ã‹\nã€€2005å¹´11æœˆã‹ã‚‰ç¿Œ2006å¹´7æœˆã¾ã§èª­å£²æ–°èã«ã¦é€£è¼‰ã•ã‚ŒãŸã€ç›´æœ¨è³ä½œå®¶ãƒ»è§’ç”°å…‰ä»£ã«ã‚ˆã‚‹åˆã®é•·ç·¨ã‚µã‚¹ãƒšãƒ³ã‚¹ã€å…«æ—¥ç›®ã®è‰ã€ã€‚2010å¹´ã«æª€ã‚Œã„ã¨åŒ—ä¹ƒãã„ã®å‡ºæ¼”ã«ã‚ˆã‚Šãƒ†ãƒ¬ãƒ“ãƒ‰ãƒ©ãƒåŒ–ã•ã‚ŒãŸåŒä½œãŒã€2011å¹´4æœˆã«æ°¸ä½œåšç¾ã¨äº•ä¸ŠçœŸå¤®ã®å‡ºæ¼”ã«ã‚ˆã£ã¦æ˜ ç”»åŒ–ã€‚ãã—ã¦ã€åŠ‡å ´å…¬é–‹ã‹ã‚‰åŠå¹´ãŒéããŸ10æœˆ28æ—¥ã€DVDï¼†ãƒ–ãƒ«ãƒ¼ãƒ¬ã‚¤ã¨ãªã£ã¦ç™ºå£²ã•ã‚Œã¾ã—ãŸã€‚\n\nå…«æ—¥ç›®ã®è‰\nã€€å¦»å­ã‚ã‚‹ç”·ã¨æ„›ã—åˆã„ã€ãã®å­ã‚’èº«ã”ã‚‚ã‚ŠãªãŒã‚‰ã€ã‚ãã‚‰ã‚ã–ã‚‹ã‚’ãˆãªã‹ã£ãŸå¥³ã€‚å½¼å¥³ã¯åŒæ™‚ã«ã€ç”·ã®å¦»ãŒå­ä¾›ã‚’ç”£ã‚“ã ã“ã¨ã‚’çŸ¥ã‚‹ã€‚ãã®èµ¤ã‚“åŠã‚’è¦‹ã«è¡Œã£ãŸå¥³ã¯ã€çªç™ºçš„ã«ãã®å­ã‚’é€£ã‚Œå»ã‚Šã€é€ƒé¿è¡Œã‚’ç¶šã‘ãŸæŒ™å¥ã€å°è±†å³¶ã«è½ã¡ç€ãã€æ¯ã¨å¨˜ã¨ã—ã¦æš®ã‚‰ã—ã¯ã˜ã‚ã‚‹ã€‚\n\n\nä¸å€«ç›¸æ‰‹ã®å­ä¾›ã‚’èª˜æ‹ã—ã€4å¹´é–“è‚²ã¦ãŸå¥³\nã€€æ°¸ä½œåšç¾ãŒæ¼”ã˜ã‚‹é‡ã€…å®®å¸Œå’Œå­ã¯ã€ä¸å€«ç›¸æ‰‹ã®å­ã‚’å®¿ã—ãªãŒã‚‰ã‚‚ã€å½¼ã®ã€Œã„ãšã‚Œå¦»ã¨åˆ¥ã‚Œã‚‹ã‹ã‚‰ã€ãã‚Œã¾ã§å¾…ã£ã¦ãã‚Œã€ã¨ã„ã†å¸¸å¥—å¥ã‚’ä¿¡ã˜ã¦ã€ä¸­çµ¶ã€‚å¾Œéºç—‡ã«ã‚ˆã‚Šã€äºŒåº¦ã¨å­ä¾›ã‚’ç”£ã‚ãªã„èº«ä½“ã¨ãªã£ã¦ã—ã¾ã„ã¾ã™ã€‚ãã®å¾Œã€ä¸å€«ç›¸æ‰‹ã‹ã‚‰å½¼ã®å¦»ãŒå‡ºç”£ã—ãŸã“ã¨ã‚’çŸ¥ã‚‰ã•ã‚Œã€åˆ¥ã‚Œã‚’æ±ºæ„ã€‚æœ€å¾Œã«è«¦ã‚ã‚’ã¤ã‘ã‚‹ãŸã‚ã€å½¼ã‚‰ã®ç”Ÿå¾Œ6ãƒ¶æœˆã®èµ¤ã‚“åŠãƒ»æµç†èœã®é¡”ã‚’è¦‹ãŸå¸Œå’Œå­ã§ã—ãŸãŒã€è‡ªåˆ†ã«ç¬‘é¡”ã§å‘ã‘ãŸæµç†èœã‚’è¦‹ã¦ã€æ€ã‚ãšèª˜æ‹ã€‚åå‰ã‚’å¤‰ãˆã¦æµç†èœã‚’è–«ã¨åä»˜ã‘ã‚‹ã¨ã€äººç›®ã‚’é¿ã‘ã¦å„åœ°ã‚’è»¢ã€…ã¨ã—ã€äºŒäººã§å¹¸ã›ãªæ™‚é–“ã‚’éã”ã—ã¾ã™ãŒã€è¾¿ã‚Šç€ã„ãŸæœ€å¾Œã®å ´æ‰€ãƒ»å°è±†å³¶ã§4å¹´ã®é€ƒé¿è¡Œã«çµ‚æ­¢ç¬¦ã‚’æ‰“ã¡ã¾ã™ã€‚\n\n...\n\n\nåˆè¨ˆ7,376ä»¶ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒã‚ã‚Šã€å¹³å‡æ–‡å­—æ•°ã¯1,200æ–‡å­—ç¨‹åº¦ã§ã™ã€‚\n\ndf.word_count.describe().astype(int)\n\ncount     7376\nmean      1259\nstd        763\nmin         37\n25%        730\n50%       1069\n75%       1602\nmax      12163\nName: word_count, dtype: int64\n\n\n æ–‡å­—æ•°ã¨ãƒˆãƒ¼ã‚¯ãƒ³æ•°ã®å‰²åˆã‚’è¦‹ã‚‹ã¨ã€ä»¥å¤–ã«1æ–‡å­—ãŒ1ãƒˆãƒ¼ã‚¯ãƒ³ã«ãªã£ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚  ã¾ãŸã€ã“ã®å‚¾å‘ãŒè¨˜äº‹ã®ç¨®é¡ã«ã‚ˆã‚Šã¾ã™ãŒã€å¤§ããªé•ã„ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚\n\ndf.word_token_ratio.mean()\n\n1.008244127016698\n\n\n\ndf.groupby(\"category\").word_token_ratio.mean().sort_values().plot.barh(figsize=(10, 5))\n\n&lt;Axes: ylabel='category'&gt;\n\n\n\n\n\nã“ã‚Œã§æ–‡å­—æ•°ã¨ãƒˆãƒ¼ã‚¯ãƒ³æ•°ã®é–¢ä¿‚ãŒã‚ã‹ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‡¦ç†ã™ã‚‹èª²é‡‘ã‚’æ¦‚ç®—è¨ˆç®—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚æ¦‚ç®—ãƒ­ã‚¸ãƒƒã‚¯ã¯ä»¥ä¸‹ã¨ä»®å®šã—ã¾ã™ã€‚\n\nã‚¤ãƒ³ãƒ—ãƒƒãƒˆã®é•·ã•ã¯2000å­—ã¨ã™ã‚‹ã€‚å†…è¨³ã¯ä»¥ä¸‹ã®é€šã‚Šã€‚\n\nå‡¦ç†ã™ã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®é•·ã•ã¯1000å­—ã¨ã™ã‚‹ã€‚\nã‚¿ã‚¹ã‚¯ã®èª¬æ˜ã‚„ã€å‡¦ç†ã®ä¾‹ã¯1000å­—ã¨ã™ã‚‹ã€‚\n\nã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã¯200å­—ã¨ã™ã‚‹ã€‚\nç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆã¯1ãƒ‰ãƒ«=135å††ã¨ã™ã‚‹ã€‚\n\nã“ã‚Œã§è¨ˆç®—ã™ã‚‹ã¨1ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‡¦ç†ã™ã‚‹ãŸã‚ã«ã¯:\n\nã‚¹ãƒ”ãƒ¼ãƒ‰ã‚’æ±‚ã‚ã‚‹gpt-3.5-turboã®å ´åˆã¯ã€0.002 * 2200 / 1000 * 135 = 0.59å†† ã‹ã‹ã‚Šã¾ã™ã€‚\næ€§èƒ½ã‚’é‡è¦–ã™ã‚‹gpt-4-32kã‚’åˆ©ç”¨ã™ã‚‹å ´åˆã¯(0.03 * 2000 + 0.06 * 200) / 1000 * 135 = 9.7å†† ã‹ã‹ã‚Šã¾ã™ã€‚"
  },
  {
    "objectID": "posts/20230505_tiktoken/index.html#tictokenã®æŒ™å‹•",
    "href": "posts/20230505_tiktoken/index.html#tictokenã®æŒ™å‹•",
    "title": "OpenAIã®GPTã®APIã®Tokenæ•°ã«é–¢ã™ã‚‹èª¿æŸ»",
    "section": "TicTokenã®æŒ™å‹•",
    "text": "TicTokenã®æŒ™å‹•\n\nBPEãƒ¢ãƒ‡ãƒ«ãŒé•ã†\næ—¥æœ¬èªã¯è‹±èªã‚ˆã‚Šãƒˆãƒ¼ã‚¯ãƒ³æ•°ãŒå¤šã„ã¨è©±ã—ã¦ã„ã‚‹æŠ•ç¨¿ã¯éå»Twitterã§è¦‹ãŸã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ä»Šå›å®Ÿéš›ã«è¨ˆç®—ã—ã¦ã¿ã‚‹ã¨ã€æ—¥æœ¬èªã®1æ–‡å­—ã¯å¤§ã‚ˆã1Tokenã«ç­‰ã—ã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚ãã‚Œã¯Decodingã™ã‚‹ãƒ¢ãƒ‡ãƒ«ãŒé•ã†ãŸã‚ã§ã™ã€‚\nã“ã“ã‹ã‚‰ã¯ã¡ã‚‡ã£ã¨æ·±ã„è©±ã‚’ã—ã¾ã™ã€‚TikTokenã¯BPE(Byte Pair Encoding)ã¨ã„ã†ãƒ‡ãƒ¼ã‚¿åœ§ç¸®æ³•ã«åŸºã¥ã„ã¦é–‹ç™ºã—ã¾ã—ãŸã€‚ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã¯æ–‡å­—ã‚’æ‰±ã†ã“ã¨ãŒã§ããªã„ã®ã§ã€æ–‡å­—ã‚’æ•°å€¤ã«å¤‰æ›ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚BPEã¯æ–‡å­—åˆ—ã‚’ã‚·ãƒ³ãƒœãƒ«ã«ç½®ãæ›ãˆã‚‹ã“ã¨ã§ã€æ–‡å­—åˆ—ã‚’æ•°å€¤ã«å¤‰æ›ã—ã¾ã™ã€‚BPEã¯é »ç¹ã«ç¾ã‚Œã‚‹æ–‡å­—ã®ãƒšã‚¢ã‚„ã€è¤‡æ•°ã®æ–‡å­—ã‚’çµ„ã¿åˆã‚ã›ãŸã‚·ãƒ³ãƒœãƒ«ã‚’ç”Ÿæˆã—ã¾ã™ã€‚ãã‚Œã«ã‚ˆã‚Šã€å…¥åŠ›ã™ã‚‹ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã®é•·ã•ã‚’çŸ­ãã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\nä¾‹ãˆã°ã€â€œab ab bâ€ã®æ–‡å­—åˆ—ã«ã¤ã„ã¦ã€â€œabâ€ã‚’0ã«ã€â€œbâ€ã‚’1ã«ç½®ãæ›ãˆã‚‹ã¨ã€â€œ0 0 1â€ã¨ã„ã†æ–‡å­—åˆ—ã«ãªã‚Šã¾ã™ã€‚ã“ã®ã‚ˆã†ã«ã€BPEã¯æ–‡å­—åˆ—ã‚’ã‚·ãƒ³ãƒœãƒ«ã«ç½®ãæ›ãˆã‚‹ã“ã¨ã§ã€ã‚‚ã¨ã‚‚ã¨é•·ã•ãŒ7ã®æ–‡å­—åˆ—ã‚’é•·ã•ãŒ5ã®ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã«å¤‰æ›ã§ãã¾ã—ãŸã€‚\nã¾ãŸã€ã©ã®çµ„ã¿åˆã‚ã›ã‚’ã‚·ãƒ³ãƒœãƒ«ã«ã™ã‚‹ã‹ã¯ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å­¦ç¿’ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦æ±ºã‚ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚gpt-3.5-turboã¨gpt-4-32kã®ãƒ¢ãƒ‡ãƒ«ã¯ä»¥å‰ã®GPT3ã®ãƒ¢ãƒ‡ãƒ«ãŒé•ã†ã®ã§ã€Tokenizeã—ãŸçµæœã‚‚é•ã„ã¾ã™ã€‚\nå®Ÿéš›ã®ä¾‹ã‚’è¦‹ã¾ã—ã‚‡ã†ã€‚\n\ngpt4_encoder = tiktoken.encoding_for_model(\"gpt-4-32k\")\ngpt3_encoder = tiktoken.encoding_for_model(\"text-davinci-003\")\n\nprint(\"GPT3ã®ãƒˆãƒ¼ã‚¯ãƒ³æ•°ï¼š\")\nprint(f\"ã“ã‚“ã«ã¡ã¯: {len(gpt3_encoder.encode('ã“ã‚“ã«ã¡ã¯'))}\")\nprint()\nprint(\"GPT4ã®ãƒˆãƒ¼ã‚¯ãƒ³æ•°ï¼š\")\nprint(f\"ã“ã‚“ã«ã¡ã¯: {len(gpt4_encoder.encode('ã“ã‚“ã«ã¡ã¯'))}\")\n\nGPT3ã®ãƒˆãƒ¼ã‚¯ãƒ³æ•°ï¼š\nã“ã‚“ã«ã¡ã¯: 6\n\nGPT4ã®ãƒˆãƒ¼ã‚¯ãƒ³æ•°ï¼š\nã“ã‚“ã«ã¡ã¯: 1\n\n\nGPT3ã®Tokenæ•°ãŒGPT4ã‚ˆã‚Šå¤šã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ä¾‹ãˆã°ã€ã€Œã“ã‚“ã«ã¡ã¯ã€ã¯GPT3ã§6Tokenã«ãªã‚Šã¾ã™ãŒã€GPT4ã§ã¯1Tokenã«ãªã‚Šã¾ã™ã€‚\n\n\nGPTã®BPEãƒ¢ãƒ‡ãƒ«ã¯æ—¥æœ¬èªã‚’ãƒã‚¤ãƒˆåŒ–ã—ã¦ã‹ã‚‰ãƒˆãƒ¼ã‚¯ãƒ³åŒ–ã—ã¦ã„ã‚‹\nã€Œã“ã‚“ã«ã¡ã¯ã€ã«ã¤ã„ã¦ã¯5æ–‡å­—ã¯ã—ã‹ãªã„ã§ã™ãŒã€ãªãœ6Tokenã«ãªã£ã¦ã„ã‚‹ã‹ã«ç–‘å•ã‚’æ€ã†ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ãã‚Œã¯GPT3ãŒå¤šè¨€èªã«å¯¾å¿œã™ã‚‹ãŸã‚ã«ã€ç›´æ¥ãƒ†ã‚­ã‚¹ãƒˆã§åˆ‡ã£ã¦ã„ãªãã¦ã€æ—¥æœ¬èªã‚’ã¾ãšãƒã‚¤ãƒˆã«å¤‰æ›ã—ã¦åˆ‡ã£ã¦ã„ã‚‹ã‹ã‚‰ã§ã™ã€‚ãƒã‚¤ãƒˆåŒ–ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šé•ã†è¨€èªã§ã‚‚å…±é€šã®Tokenã§è¡¨ç¾ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\n\ntokeinzer_result_byte = gpt3_encoder.decode_tokens_bytes(gpt3_encoder.encode('ã“ã‚“ã«ã¡ã¯'))\nprint(\"Tokenizeçµæœ:\", tokeinzer_result_byte)\ntokeinzer_result = [i.decode() if len(i) == 3 else i for i in tokeinzer_result_byte ]\nprint(\"Decodingçµæœ:\", tokeinzer_result)\n\nTokenizeçµæœ: [b'\\xe3\\x81\\x93', b'\\xe3\\x82\\x93', b'\\xe3\\x81\\xab', b'\\xe3\\x81', b'\\xa1', b'\\xe3\\x81\\xaf']\nDecodingçµæœ: ['ã“', 'ã‚“', 'ã«', b'\\xe3\\x81', b'\\xa1', 'ã¯']\n\n\nä¸Šè¨˜ã®çµæœã‹ã‚‰ã‚ã‹ã‚‹ã“ã¨ã¨ã—ã¦ã¯ã€æ—¥æœ¬èª1ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã¯3ãƒã‚¤ãƒˆã§è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚ã€Œã“ã‚“ã«ã¡ã¯ã€ã®ä¸­ã®ã€Œã¡ã€ã®ã¿2Tokenã«åˆ†è§£ã•ã‚Œã¾ã—ãŸã€‚\n\n\nå®Ÿéš›ã®æ¯”è¼ƒ\nã¤ãã«ã€å®Ÿéš›ã«ãƒ‡ãƒ¼ã‚¿ã§GPT3ã¨GPT4ã®Tokenizeã®çµæœã‚’æ¯”è¼ƒã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚\n\ndf[\"token_ids_gpt3\"] = df[\"text\"].apply(lambda x: gpt3_encoder.encode(x))\ndf[\"token_count_gpt3\"] = df[\"token_ids_gpt3\"].apply(lambda x: len(x))\ndf[\"word_token_ratio_gpt3\"] = df[\"token_count_gpt3\"] / df[\"word_count\"]\ndf[\"word_token_ratio_gpt3\"].mean()\n\n1.317645208825121"
  },
  {
    "objectID": "posts/20230505_tiktoken/index.html#ã¾ã¨ã‚",
    "href": "posts/20230505_tiktoken/index.html#ã¾ã¨ã‚",
    "title": "OpenAIã®GPTã®APIã®Tokenæ•°ã«é–¢ã™ã‚‹èª¿æŸ»",
    "section": "ã¾ã¨ã‚",
    "text": "ã¾ã¨ã‚\néå»ã«GPT3ã‚’ä½¿ã†å ´åˆã¯æ—¥æœ¬èªã®Tokenæ•°ã¯è‹±èªã®2å€ã«ãªã‚‹å™‚ãŒã‚ã‚Šã¾ã™ã€‚GPTãƒ¢ãƒ‡ãƒ«ã§æ—¥æœ¬èªã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‡¦ç†ã™ã‚‹éš›ã€1æ–‡å­—ã¯ãŠãŠã‚ˆã1ãƒˆãƒ¼ã‚¯ãƒ³ã«ç­‰ã—ã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚åƒæ–‡å­—ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‡¦ç†ã™ã‚‹ãŸã‚ã®æ¦‚ç®—ã‚³ã‚¹ãƒˆã¯ã€ã‚¹ãƒ”ãƒ¼ãƒ‰é‡è¦–ã®gpt-3.5-turboã‚’ä½¿ã†å ´åˆã¯0.59å††ã€æ€§èƒ½é‡è¦–ã®gpt-4-32kã‚’åˆ©ç”¨ã™ã‚‹å ´åˆã¯9.7å††ã§ã™ã€‚\nã¾ãŸã€GPT3ã¨GPT4ãŒä½¿ã†TokenizerãŒé•ã„ã€GPT3ã®ãƒˆãƒ¼ã‚¯ãƒ³æ•°ã¯ãŠãŠã‚ˆãGPT4ã®1.3å€ã«ãªã‚Šã¾ã™ã€‚"
  },
  {
    "objectID": "posts/20230501_inpars_v2/index.html",
    "href": "posts/20230501_inpars_v2/index.html",
    "title": "InPars V2 è«–æ–‡è§£èª­",
    "section": "",
    "text": "InPars V2è«–æ–‡ã§ã¯ã€Queryç”Ÿæˆã«ä½¿ç”¨ã™ã‚‹LLMãŒGPT3ã‹ã‚‰ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã®GPT-J(6B)ã«å¤‰æ›´ã•ã‚Œã€ç”Ÿæˆã—ãŸQueryã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ–¹æ³•ãŒLog Probabilityã‹ã‚‰monot5(3B)ã‚’Rerankerã¨ã—ã¦åˆ©ç”¨ã™ã‚‹æ–¹æ³•ã«å¤‰æ›´ã•ã‚ŒãŸç‚¹ã‚’æŒ™ã’ã¦ã„ã‚‹ã€‚å®Ÿé¨“çµæœã¨ã—ã¦ã¯ã€V2ã®ç²¾åº¦ãŒV1ã¨æ¯”ã¹ã¦ã‚ãšã‹ã«å‘ä¸Šã—ãŸã“ã¨ãŒå ±å‘Šã•ã‚Œã¦ã„ã‚‹ã€‚\nè«–æ–‡URLï¼šhttps://arxiv.org/abs/2301.01820"
  },
  {
    "objectID": "posts/20230501_inpars_v2/index.html#introduction",
    "href": "posts/20230501_inpars_v2/index.html#introduction",
    "title": "InPars V2 è«–æ–‡è§£èª­",
    "section": "1 Introduction",
    "text": "1 Introduction\nInPars v1ã¨v2ã®é•ã„ã¯ã€ä¸»ã«ä»¥ä¸‹ã®2ç‚¹ï¼š\n\n\n\n\n\n\n\n\nDifference\nInPars v1\nInPars v2\n\n\n\n\nQueryã‚’ç”Ÿæˆã™ã‚‹LLM\nGPT3\nGPT-J(6B) (ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹)\n\n\nç”Ÿæˆã—ãŸQueryã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ–¹æ³•\nç”Ÿæˆæ™‚ã®Log Probabilityã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°\nmonot5(3B)ã‚’Rerankerã¨ã—ã¦ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°"
  },
  {
    "objectID": "posts/20230501_inpars_v2/index.html#methodology",
    "href": "posts/20230501_inpars_v2/index.html#methodology",
    "title": "InPars V2 è«–æ–‡è§£èª­",
    "section": "2 Methodology",
    "text": "2 Methodology\nBEIRã®å„ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«å¯¾ã—ã¦100kã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã™ã‚‹ã€‚MS MARCOã‹ã‚‰ã®3ã¤ã®ä¾‹ã‚’åˆ©ç”¨ã—ã¦GBQã®å½¢å¼ã§Promptã‚’ä½œæˆã—ã€å„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«å¯¾ã—ã¦ä¸€å€‹ã®Queryã‚’ç”Ÿæˆã™ã‚‹ã€‚GPT-J(6B)ã‚’åˆ©ç”¨ã—ã¦Queryã‚’ç”Ÿæˆã—ãŸã€‚A100ä¸€æšã§100kã®Queryã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã«ã¯30æ™‚é–“ã‹ã‹ã‚‹ã€‚\nãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã«ã¤ã„ã¦ã¯ä»¥å‰ã¯ç”Ÿæˆæ™‚ã®Log ProbabilityãŒä¸Šä½ã®10kã®ãƒšã‚¢ã‚’é¸ã‚“ã ãŒã€ä»Šå›ã¯MS-MARCOã§Fine-tuningã—ãŸã‚‚ã®T5-3Bã‚’Rerankerã¨ã—ã¦ä½¿ã£ãŸã€‚100kã®Queryã¨Documentã®ãƒšã‚¢ã«ã¤ã„ã¦ç›¸é–¢åº¦ã‚’å‡ºã—ã¦ã€ä¸Šä½ã®10kãƒšã‚¢ã‚’åˆ©ç”¨ã—ãŸã€‚\nNegative sampleã¯ã¾ãŸå„Queryã«ã¤ã„ã¦BM25ã§ä¸Šä½1000ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä¸­ã§1å€‹ãƒ©ãƒ³ãƒ€ãƒ é¸ã‚“ã ã€‚"
  },
  {
    "objectID": "posts/20230501_inpars_v2/index.html#result",
    "href": "posts/20230501_inpars_v2/index.html#result",
    "title": "InPars V2 è«–æ–‡è§£èª­",
    "section": "3 Result",
    "text": "3 Result\n\n\n\nresult\n\n\nå®Ÿé¨“çµæœã‚’è¦‹ã‚‹ã¨ã€v2ã¯v1ã¨æ¯”ã¹ã¦ç²¾åº¦ãŒå°‘ã—è‰¯ããªã£ãŸ(0.006)ã€‚"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "è‡ªç„¶è¨€èªå‡¦ç†æŠ€è¡“ãƒ–ãƒ­ã‚°",
    "section": "",
    "text": "Order By\n       Default\n         \n          Title\n        \n         \n          Date - Oldest\n        \n         \n          Date - Newest\n        \n     \n  \n    \n      \n      \n    \n\n\n\n\n  \n\n\n\n\nAzure OpenAI Serviceã®åˆ©ç”¨ã«ã¤ã„ã¦\n\n\n\n\n\n\n\nNLP\n\n\nLLMs\n\n\nLangChain\n\n\n\n\n\n\n\n\n\n\n\nMay 10, 2023\n\n\n\n\n\n\n  \n\n\n\n\nLangChain Agentã®å…¨é¢è§£èª¬\n\n\n\n\n\n\n\nNLP\n\n\nLLMs\n\n\nLangChain\n\n\n\n\n\n\n\n\n\n\n\nMay 9, 2023\n\n\n\n\n\n\n  \n\n\n\n\nLangChainã®ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ã‚’å…¨é¢è§£èª¬ã™ã‚‹\n\n\n\n\n\n\n\nNLP\n\n\nLLMs\n\n\nLangChain\n\n\n\n\n\n\n\n\n\n\n\nMay 6, 2023\n\n\n\n\n\n\n  \n\n\n\n\nOpenAIã®GPTã®APIã®Tokenæ•°ã«é–¢ã™ã‚‹èª¿æŸ»\n\n\n\n\n\n\n\nNLP\n\n\nLLMs\n\n\nLangChain\n\n\n\n\n\n\n\n\n\n\n\nMay 5, 2023\n\n\n\n\n\n\n  \n\n\n\n\nInPars light è«–æ–‡è§£èª­\n\n\n\n\n\n\n\nNLP\n\n\nInformation_retrieval\n\n\npaper\n\n\n\n\n\n\n\n\n\n\n\nMay 2, 2023\n\n\n\n\n\n\n  \n\n\n\n\nInPars V2 è«–æ–‡è§£èª­\n\n\n\n\n\n\n\nNLP\n\n\nInformation_retrieval\n\n\npaper\n\n\n\n\n\n\n\n\n\n\n\nMay 1, 2023\n\n\n\n\n\n\n  \n\n\n\n\nHyDE è«–æ–‡è§£èª­\n\n\n\n\n\n\n\nNLP\n\n\nInformation_retrieval\n\n\npaper\n\n\n\n\n\n\n\n\n\n\n\nApr 30, 2023\n\n\n\n\n\n\n  \n\n\n\n\nPromptagator è«–æ–‡è§£èª­\n\n\n\n\n\n\n\nNLP\n\n\nInformation_retrieval\n\n\npaper\n\n\n\n\n\n\n\n\n\n\n\nApr 29, 2023\n\n\n\n\n\n\n  \n\n\n\n\nInPars è«–æ–‡è§£èª­\n\n\n\n\n\n\n\nNLP\n\n\nInformation_retrieval\n\n\npaper\n\n\n\n\n\n\n\n\n\n\n\nApr 29, 2023\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "ã“ã®ãƒ–ãƒ­ã‚°ã§ã¯ã€è‡ªåˆ†ãŒå­¦ã‚“ã çŸ¥è­˜ã‚„çµŒé¨“ã‚’å…±æœ‰ã—ã€çš†ã•ã‚“ã¨ä¸€ç·’ã«æˆé•·ã—ã¦ã„ãã“ã¨ã‚’ç›®æŒ‡ã—ã¦ã„ã¾ã™ã€‚ã©ã†ãã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚"
  },
  {
    "objectID": "about.html#è‡ªå·±ç´¹ä»‹",
    "href": "about.html#è‡ªå·±ç´¹ä»‹",
    "title": "About",
    "section": "è‡ªå·±ç´¹ä»‹",
    "text": "è‡ªå·±ç´¹ä»‹\nç§ã¯2017å¹´ã‹ã‚‰ç¤¾ä¼šäººã¨ã—ã¦åƒãå§‹ã‚ã€ã“ã‚Œã¾ã§ã«æ•°ã€…ã®ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ã‚¹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’çµŒé¨“ã—ã¦ãã¾ã—ãŸã€‚è‡ªç„¶è¨€èªå‡¦ç†ã«å¼·ã„é–¢å¿ƒã‚’æŒã¡ã€Kaggleã‚„Signateãªã©ã§ã‚³ãƒ³ãƒšã«å‚åŠ ã—ã¦ã„ã¾ã™ã€‚è©³ç´°ã¯LinkedInã‚’ã”è¦§ãã ã•ã„ã€‚"
  },
  {
    "objectID": "about.html#ã“ã®ãƒ–ãƒ­ã‚°ã®ç›®çš„",
    "href": "about.html#ã“ã®ãƒ–ãƒ­ã‚°ã®ç›®çš„",
    "title": "About",
    "section": "ã“ã®ãƒ–ãƒ­ã‚°ã®ç›®çš„",
    "text": "ã“ã®ãƒ–ãƒ­ã‚°ã®ç›®çš„\nãƒ–ãƒ­ã‚°ã‚’æ›¸ãç›®çš„ã¯ä¸»ã«ä»¥ä¸‹ã®3ã¤ã§ã™ã€‚\n\nå­¦ã‚“ã çŸ¥è­˜ã®ç†è§£ã‚’æ·±ã‚ã‚‹ãŸã‚ï¼š å­¦ã‚“ã ã“ã¨ã‚’ä»–äººã«æ•™ãˆã‚‹ã“ã¨ã¯ã€è‡ªåˆ†è‡ªèº«ã®ç†è§£ã‚’æ·±ã‚ã‚‹ã“ã¨ã«ç¹‹ãŒã‚Šã¾ã™ã€‚è‡ªåˆ†ãŒç†è§£ã§ãã¦ã„ãªã„å†…å®¹ã¯ä»–äººã«æ•™ãˆã‚‰ã‚Œãªã„ãŸã‚ã€æ•™ãˆã‚‹ã“ã¨ã‚’é€šã˜ã¦è‡ªç„¶ã¨ç†è§£ãŒæ·±ã¾ã‚Šã¾ã™ã€‚\nãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’å……å®Ÿã•ã›ã‚‹ãŸã‚ï¼š ä»Šå¾Œè‡ªå·±ç´¹ä»‹ãŒå¿…è¦ã«ãªã£ãŸéš›ã«ã€ã“ã®ãƒ–ãƒ­ã‚°ã®ãƒªãƒ³ã‚¯ã‚’å…±æœ‰ã™ã‚‹ã“ã¨ã§ç›¸æ‰‹ã«è‡ªåˆ†ã®èˆˆå‘³ã‚„æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ã‚’çŸ¥ã£ã¦ã‚‚ã‚‰ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚\nä»–äººã®å½¹ã«ç«‹ã¤æƒ…å ±ã‚’æä¾›ã™ã‚‹ãŸã‚ï¼š ã“ã‚Œã¾ã§ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆä¸Šã®ç„¡æ–™ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®æ©æµã‚’å—ã‘ã¦ãã¾ã—ãŸã€‚ç§ã‚‚ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®æ¶ˆè²»è€…ã ã‘ã§ãªãã€æä¾›è€…ã¨ã—ã¦ã‚‚æ´»èºã—ãŸã„ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚"
  }
]